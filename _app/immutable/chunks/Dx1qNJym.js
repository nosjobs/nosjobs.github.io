var Do=Object.defineProperty;var zo=(e,t,n)=>t in e?Do(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var I=(e,t,n)=>zo(e,typeof t!="symbol"?t+"":t,n);import{B as tr,ad as Ot,N as nr,ay as Gt,C as Be,a8 as Vo,aL as Ko,aj as Zo,u as Fo,aM as Go,aN as Jo,aO as Yo,aP as Xo,aQ as Qo,j as ei,g as ti,aR as ni,K as Un}from"./BmXvJSi1.js";import{l as ri,j as oi,k as ii,n as si,o as ai,p as ci,q as ui,v as li}from"./ClwMVX8E.js";function fi(e,t){var n=void 0,r;tr(()=>{n!==(n=t())&&(r&&(Ot(r),r=null),n&&(r=nr(()=>{Gt(()=>n(e))})))})}function rr(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=rr(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function di(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=rr(e))&&(r&&(r+=" "),r+=t);return r}function hi(e){return typeof e=="object"?di(e):e??""}const Nn=[...` 	
\r\fÂ \v\uFEFF`];function pi(e,t,n){var r=e==null?"":""+e;if(n){for(var o in n)if(n[o])r=r?r+" "+o:o;else if(r.length)for(var i=o.length,s=0;(s=r.indexOf(o,s))>=0;){var a=s+i;(s===0||Nn.includes(r[s-1]))&&(a===r.length||Nn.includes(r[a]))?r=(s===0?"":r.substring(0,s))+r.substring(a+1):s=a}}return r===""?null:r}function Cn(e,t=!1){var n=t?" !important;":";",r="";for(var o in e){var i=e[o];i!=null&&i!==""&&(r+=" "+o+": "+i+n)}return r}function At(e){return e[0]!=="-"||e[1]!=="-"?e.toLowerCase():e}function gi(e,t){if(t){var n="",r,o;if(Array.isArray(t)?(r=t[0],o=t[1]):r=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var i=!1,s=0,a=!1,c=[];r&&c.push(...Object.keys(r).map(At)),o&&c.push(...Object.keys(o).map(At));var l=0,f=-1;const d=e.length;for(var u=0;u<d;u++){var h=e[u];if(a?h==="/"&&e[u-1]==="*"&&(a=!1):i?i===h&&(i=!1):h==="/"&&e[u+1]==="*"?a=!0:h==='"'||h==="'"?i=h:h==="("?s++:h===")"&&s--,!a&&i===!1&&s===0){if(h===":"&&f===-1)f=u;else if(h===";"||u===d-1){if(f!==-1){var y=At(e.substring(l,f).trim());if(!c.includes(y)){h!==";"&&u++;var w=e.substring(l,u).trim();n+=" "+w+";"}}l=u+1,f=-1}}}}return r&&(n+=Cn(r)),o&&(n+=Cn(o,!0)),n=n.trim(),n===""?null:n}return e==null?null:String(e)}function yi(e,t,n,r,o,i){var s=e.__className;if(Be||s!==n||s===void 0){var a=pi(n,r,i);(!Be||a!==e.getAttribute("class"))&&(a==null?e.removeAttribute("class"):t?e.className=a:e.setAttribute("class",a)),e.__className=n}else if(i&&o!==i)for(var c in i){var l=!!i[c];(o==null||l!==!!o[c])&&e.classList.toggle(c,l)}return i}function St(e,t={},n,r){for(var o in n){var i=n[o];t[o]!==i&&(n[o]==null?e.style.removeProperty(o):e.style.setProperty(o,i,r))}}function wi(e,t,n,r){var o=e.__style;if(Be||o!==t){var i=gi(t,r);(!Be||i!==e.getAttribute("style"))&&(i==null?e.removeAttribute("style"):e.style.cssText=i),e.__style=t}else r&&(Array.isArray(r)?(St(e,n==null?void 0:n[0],r[0]),St(e,n==null?void 0:n[1],r[1],"important")):St(e,n,r));return r}function Xe(e,t,n){if(e.multiple){if(t==null)return;if(!Vo(t))return Ko();for(var r of e.options)r.selected=t.includes(Ke(r));return}for(r of e.options){var o=Ke(r);if(Zo(o,t)){r.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function or(e,t){let n=!0;Gt(()=>{t&&Xe(e,Fo(t),n),n=!1;var r=new MutationObserver(()=>{var o=e.__value;Xe(e,o)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function cl(e,t,n=t){var r=!0;ri(e,"change",o=>{var i=o?"[selected]":":checked",s;if(e.multiple)s=[].map.call(e.querySelectorAll(i),Ke);else{var a=e.querySelector(i)??e.querySelector("option:not([disabled])");s=a&&Ke(a)}n(s)}),Gt(()=>{var o=t();if(Xe(e,o,r),r&&o===void 0){var i=e.querySelector(":checked");i!==null&&(o=Ke(i),n(o))}e.__value=o,r=!1}),or(e)}function Ke(e){return"__value"in e?e.__value:e.value}const je=Symbol("class"),De=Symbol("style"),ir=Symbol("is custom element"),sr=Symbol("is html");function ul(e){if(Be){var t=!1,n=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var r=e.value;Qe(e,"value",null),e.value=r}if(e.hasAttribute("checked")){var o=e.checked;Qe(e,"checked",null),e.checked=o}}};e.__on_r=n,Qo(n),oi()}}function bi(e,t){t?e.hasAttribute("selected")||e.setAttribute("selected",""):e.removeAttribute("selected")}function Qe(e,t,n,r){var o=ar(e);Be&&(o[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||o[t]!==(o[t]=n)&&(t==="loading"&&(e[Go]=n),n==null?e.removeAttribute(t):typeof n!="string"&&cr(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function vi(e,t,n,r,o=!1){var i=ar(e),s=i[ir],a=!i[sr];let c=Be&&s;c&&Un(!1);var l=t||{},f=e.tagName==="OPTION";for(var u in t)u in n||(n[u]=null);n.class?n.class=hi(n.class):n[je]&&(n.class=null),n[De]&&(n.style??(n.style=null));var h=cr(e);for(const m in n){let S=n[m];if(f&&m==="value"&&S==null){e.value=e.__value="",l[m]=S;continue}if(m==="class"){var y=e.namespaceURI==="http://www.w3.org/1999/xhtml";yi(e,y,S,r,t==null?void 0:t[je],n[je]),l[m]=S,l[je]=n[je];continue}if(m==="style"){wi(e,S,t==null?void 0:t[De],n[De]),l[m]=S,l[De]=n[De];continue}var w=l[m];if(S!==w){l[m]=S;var d=m[0]+m[1];if(d!=="$$")if(d==="on"){const B={},x="$$"+m;let E=m.slice(2);var p=li(E);if(ii(E)&&(E=E.slice(0,-7),B.capture=!0),!p&&w){if(S!=null)continue;e.removeEventListener(E,l[x],B),l[x]=null}if(S!=null)if(p)e[`__${E}`]=S,ai([E]);else{let _=function(O){l[m].call(this,O)};l[x]=si(E,e,_,B)}else p&&(e[`__${E}`]=void 0)}else if(m==="style")Qe(e,m,S);else if(m==="autofocus")ci(e,!!S);else if(!s&&(m==="__value"||m==="value"&&S!=null))e.value=e.__value=S;else if(m==="selected"&&f)bi(e,S);else{var g=m;a||(g=ui(g));var A=g==="defaultValue"||g==="defaultChecked";if(S==null&&!s&&!A)if(i[m]=null,g==="value"||g==="checked"){let B=e;const x=t===void 0;if(g==="value"){let E=B.defaultValue;B.removeAttribute(g),B.defaultValue=E,B.value=B.__value=x?E:null}else{let E=B.defaultChecked;B.removeAttribute(g),B.defaultChecked=E,B.checked=x?E:!1}}else e.removeAttribute(m);else A||h.includes(g)&&(s||typeof S!="string")?e[g]=S:typeof S!="function"&&Qe(e,g,S)}}}return c&&Un(!0),l}function ll(e,t,n=[],r,o=!1,i=ei){const s=n.map(i);var a=void 0,c={},l=e.nodeName==="SELECT",f=!1;tr(()=>{var u=t(...s.map(ti));vi(e,a,u,r,o),f&&l&&"value"in u&&Xe(e,u.value,!1);for(let y of Object.getOwnPropertySymbols(c))u[y]||Ot(c[y]);for(let y of Object.getOwnPropertySymbols(u)){var h=u[y];y.description===ni&&(!a||h!==a[y])&&(c[y]&&Ot(c[y]),c[y]=nr(()=>fi(e,()=>h)))}a=u}),l&&or(e,()=>a.value),f=!0}function ar(e){return e.__attributes??(e.__attributes={[ir]:e.nodeName.includes("-"),[sr]:e.namespaceURI===Jo})}var On=new Map;function cr(e){var t=On.get(e.nodeName);if(t)return t;On.set(e.nodeName,t=[]);for(var n,r=e,o=Element.prototype;o!==r;){n=Xo(r);for(var i in n)n[i].set&&t.push(i);r=Yo(r)}return t}function Hn(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function ur(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Ei(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Hn(e.outputLen),Hn(e.blockLen)}function et(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function mi(e,t){ur(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const _t=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const lr=e=>e instanceof Uint8Array,Bt=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),ee=(e,t)=>e<<32-t|e>>>t,xi=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!xi)throw new Error("Non little-endian hardware is not supported");function Ai(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Jt(e){if(typeof e=="string"&&(e=Ai(e)),!lr(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function Si(...e){const t=new Uint8Array(e.reduce((r,o)=>r+o.length,0));let n=0;return e.forEach(r=>{if(!lr(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}let fr=class{clone(){return this._cloneInto()}};function _i(e){const t=r=>e().update(Jt(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function dr(e=32){if(_t&&typeof _t.getRandomValues=="function")return _t.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function Bi(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,l=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+l,a,r)}let Ti=class extends fr{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Bt(this.buffer)}update(t){et(this);const{view:n,buffer:r,blockLen:o}=this;t=Jt(t);const i=t.length;for(let s=0;s<i;){const a=Math.min(o-this.pos,i-s);if(a===o){const c=Bt(t);for(;o<=i-s;s+=o)this.process(c,s);continue}r.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){et(this),mi(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:i}=this;let{pos:s}=this;n[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>o-s&&(this.process(r,0),s=0);for(let u=s;u<o;u++)n[u]=0;Bi(r,o-8,BigInt(this.length*8),i),this.process(r,0);const a=Bt(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,f=this.get();if(l>f.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<l;u++)a.setUint32(4*u,f[u],i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:i,destroyed:s,pos:a}=this;return t.length=o,t.pos=a,t.finished=i,t.destroyed=s,o%n&&t.buffer.set(r),t}};const Ii=(e,t,n)=>e&t^~e&n,Li=(e,t,n)=>e&t^e&n^t&n,ki=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),pe=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ge=new Uint32Array(64);let $i=class extends Ti{constructor(){super(64,32,8,!1),this.A=pe[0]|0,this.B=pe[1]|0,this.C=pe[2]|0,this.D=pe[3]|0,this.E=pe[4]|0,this.F=pe[5]|0,this.G=pe[6]|0,this.H=pe[7]|0}get(){const{A:t,B:n,C:r,D:o,E:i,F:s,G:a,H:c}=this;return[t,n,r,o,i,s,a,c]}set(t,n,r,o,i,s,a,c){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=a|0,this.H=c|0}process(t,n){for(let u=0;u<16;u++,n+=4)ge[u]=t.getUint32(n,!1);for(let u=16;u<64;u++){const h=ge[u-15],y=ge[u-2],w=ee(h,7)^ee(h,18)^h>>>3,d=ee(y,17)^ee(y,19)^y>>>10;ge[u]=d+ge[u-7]+w+ge[u-16]|0}let{A:r,B:o,C:i,D:s,E:a,F:c,G:l,H:f}=this;for(let u=0;u<64;u++){const h=ee(a,6)^ee(a,11)^ee(a,25),y=f+h+Ii(a,c,l)+ki[u]+ge[u]|0,d=(ee(r,2)^ee(r,13)^ee(r,22))+Li(r,o,i)|0;f=l,l=c,c=a,a=s+y|0,s=i,i=o,o=r,r=y+d|0}r=r+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,f=f+this.H|0,this.set(r,o,i,s,a,c,l,f)}roundClean(){ge.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Ht=_i(()=>new $i);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const hr=BigInt(0),st=BigInt(1),Ri=BigInt(2),at=e=>e instanceof Uint8Array,Ui=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Ce(e){if(!at(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=Ui[e[n]];return t}function pr(e){const t=e.toString(16);return t.length&1?`0${t}`:t}function Yt(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function Oe(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let r=0;r<n.length;r++){const o=r*2,i=e.slice(o,o+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");n[r]=s}return n}function F(e){return Yt(Ce(e))}function Xt(e){if(!at(e))throw new Error("Uint8Array expected");return Yt(Ce(Uint8Array.from(e).reverse()))}function Ee(e,t){return Oe(e.toString(16).padStart(t*2,"0"))}function Qt(e,t){return Ee(e,t).reverse()}function Ni(e){return Oe(pr(e))}function V(e,t,n){let r;if(typeof t=="string")try{r=Oe(t)}catch(i){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${i}`)}else if(at(t))r=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);const o=r.length;if(typeof n=="number"&&o!==n)throw new Error(`${e} expected ${n} bytes, got ${o}`);return r}function Te(...e){const t=new Uint8Array(e.reduce((r,o)=>r+o.length,0));let n=0;return e.forEach(r=>{if(!at(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}function Ci(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Oi(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Hi(e){let t;for(t=0;e>hr;e>>=st,t+=1);return t}function Pi(e,t){return e>>BigInt(t)&st}const Mi=(e,t,n)=>e|(n?st:hr)<<BigInt(t),en=e=>(Ri<<BigInt(e-1))-st,Tt=e=>new Uint8Array(e),Pn=e=>Uint8Array.from(e);function gr(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=Tt(e),o=Tt(e),i=0;const s=()=>{r.fill(1),o.fill(0),i=0},a=(...u)=>n(o,r,...u),c=(u=Tt())=>{o=a(Pn([0]),u),r=a(),u.length!==0&&(o=a(Pn([1]),u),r=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let u=0;const h=[];for(;u<t;){r=a();const y=r.slice();h.push(y),u+=r.length}return Te(...h)};return(u,h)=>{s(),c(u);let y;for(;!(y=h(l()));)c();return s(),y}}const qi={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function Ge(e,t,n={}){const r=(o,i,s)=>{const a=qi[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const c=e[o];if(!(s&&c===void 0)&&!a(c,e))throw new Error(`Invalid param ${String(o)}=${c} (${typeof c}), expected ${i}`)};for(const[o,i]of Object.entries(t))r(o,i,!1);for(const[o,i]of Object.entries(n))r(o,i,!0);return e}const Wi=Object.freeze(Object.defineProperty({__proto__:null,bitGet:Pi,bitLen:Hi,bitMask:en,bitSet:Mi,bytesToHex:Ce,bytesToNumberBE:F,bytesToNumberLE:Xt,concatBytes:Te,createHmacDrbg:gr,ensureBytes:V,equalBytes:Ci,hexToBytes:Oe,hexToNumber:Yt,numberToBytesBE:Ee,numberToBytesLE:Qt,numberToHexUnpadded:pr,numberToVarBytesBE:Ni,utf8ToBytes:Oi,validateObject:Ge},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const D=BigInt(0),j=BigInt(1),Se=BigInt(2),ji=BigInt(3),Pt=BigInt(4),Mn=BigInt(5),qn=BigInt(8);BigInt(9);BigInt(16);function z(e,t){const n=e%t;return n>=D?n:t+n}function Di(e,t,n){if(n<=D||t<D)throw new Error("Expected power/modulo > 0");if(n===j)return D;let r=j;for(;t>D;)t&j&&(r=r*e%n),e=e*e%n,t>>=j;return r}function G(e,t,n){let r=e;for(;t-- >D;)r*=r,r%=n;return r}function Mt(e,t){if(e===D||t<=D)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=z(e,t),r=t,o=D,i=j;for(;n!==D;){const a=r/n,c=r%n,l=o-i*a;r=n,n=c,o=i,i=l}if(r!==j)throw new Error("invert: does not exist");return z(o,t)}function zi(e){const t=(e-j)/Se;let n,r,o;for(n=e-j,r=0;n%Se===D;n/=Se,r++);for(o=Se;o<e&&Di(o,t,e)!==e-j;o++);if(r===1){const s=(e+j)/Pt;return function(c,l){const f=c.pow(l,s);if(!c.eql(c.sqr(f),l))throw new Error("Cannot find square root");return f}}const i=(n+j)/Se;return function(a,c){if(a.pow(c,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=r,f=a.pow(a.mul(a.ONE,o),n),u=a.pow(c,i),h=a.pow(c,n);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let y=1;for(let d=a.sqr(h);y<l&&!a.eql(d,a.ONE);y++)d=a.sqr(d);const w=a.pow(f,j<<BigInt(l-y-1));f=a.sqr(w),u=a.mul(u,w),h=a.mul(h,f),l=y}return u}}function Vi(e){if(e%Pt===ji){const t=(e+j)/Pt;return function(r,o){const i=r.pow(o,t);if(!r.eql(r.sqr(i),o))throw new Error("Cannot find square root");return i}}if(e%qn===Mn){const t=(e-Mn)/qn;return function(r,o){const i=r.mul(o,Se),s=r.pow(i,t),a=r.mul(o,s),c=r.mul(r.mul(a,Se),s),l=r.mul(a,r.sub(c,r.ONE));if(!r.eql(r.sqr(l),o))throw new Error("Cannot find square root");return l}}return zi(e)}const Ki=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Zi(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=Ki.reduce((r,o)=>(r[o]="function",r),t);return Ge(e,n)}function Fi(e,t,n){if(n<D)throw new Error("Expected power > 0");if(n===D)return e.ONE;if(n===j)return t;let r=e.ONE,o=t;for(;n>D;)n&j&&(r=e.mul(r,o)),o=e.sqr(o),n>>=j;return r}function Gi(e,t){const n=new Array(t.length),r=t.reduce((i,s,a)=>e.is0(s)?i:(n[a]=i,e.mul(i,s)),e.ONE),o=e.inv(r);return t.reduceRight((i,s,a)=>e.is0(s)?i:(n[a]=e.mul(i,n[a]),e.mul(i,s)),o),n}function yr(e,t){const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Ji(e,t,n=!1,r={}){if(e<=D)throw new Error(`Expected Field ORDER > 0, got ${e}`);const{nBitLength:o,nByteLength:i}=yr(e,t);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=Vi(e),a=Object.freeze({ORDER:e,BITS:o,BYTES:i,MASK:en(o),ZERO:D,ONE:j,create:c=>z(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return D<=c&&c<e},is0:c=>c===D,isOdd:c=>(c&j)===j,neg:c=>z(-c,e),eql:(c,l)=>c===l,sqr:c=>z(c*c,e),add:(c,l)=>z(c+l,e),sub:(c,l)=>z(c-l,e),mul:(c,l)=>z(c*l,e),pow:(c,l)=>Fi(a,c,l),div:(c,l)=>z(c*Mt(l,e),e),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Mt(c,e),sqrt:r.sqrt||(c=>s(a,c)),invertBatch:c=>Gi(a,c),cmov:(c,l,f)=>f?l:c,toBytes:c=>n?Qt(c,i):Ee(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return n?Xt(c):F(c)}});return Object.freeze(a)}function wr(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function br(e){const t=wr(e);return t+Math.ceil(t/2)}function Yi(e,t,n=!1){const r=e.length,o=wr(t),i=br(t);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const s=n?F(e):Xt(e),a=z(s,t-j)+j;return n?Qt(a,o):Ee(a,o)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Xi=BigInt(0),It=BigInt(1);function Qi(e,t){const n=(o,i)=>{const s=i.negate();return o?s:i},r=o=>{const i=Math.ceil(t/o)+1,s=2**(o-1);return{windows:i,windowSize:s}};return{constTimeNegate:n,unsafeLadder(o,i){let s=e.ZERO,a=o;for(;i>Xi;)i&It&&(s=s.add(a)),a=a.double(),i>>=It;return s},precomputeWindow(o,i){const{windows:s,windowSize:a}=r(i),c=[];let l=o,f=l;for(let u=0;u<s;u++){f=l,c.push(f);for(let h=1;h<a;h++)f=f.add(l),c.push(f);l=f.double()}return c},wNAF(o,i,s){const{windows:a,windowSize:c}=r(o);let l=e.ZERO,f=e.BASE;const u=BigInt(2**o-1),h=2**o,y=BigInt(o);for(let w=0;w<a;w++){const d=w*c;let p=Number(s&u);s>>=y,p>c&&(p-=h,s+=It);const g=d,A=d+Math.abs(p)-1,m=w%2!==0,S=p<0;p===0?f=f.add(n(m,i[g])):l=l.add(n(S,i[A]))}return{p:l,f}},wNAFCached(o,i,s,a){const c=o._WINDOW_SIZE||1;let l=i.get(o);return l||(l=this.precomputeWindow(o,c),c!==1&&i.set(o,a(l))),this.wNAF(c,l,s)}}}function vr(e){return Zi(e.Fp),Ge(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...yr(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function es(e){const t=vr(e);Ge(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:o}=t;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:ts,hexToBytes:ns}=Wi,_e={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){const{Err:t}=_e;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");const n=e[1],r=e.subarray(2,n+2);if(!n||r.length!==n)throw new t("Invalid signature integer: wrong length");if(r[0]&128)throw new t("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:ts(r),l:e.subarray(n+2)}},toSig(e){const{Err:t}=_e,n=typeof e=="string"?ns(e):e;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new t("Invalid signature tag");if(n[1]!==r-2)throw new t("Invalid signature: incorrect length");const{d:o,l:i}=_e._parseInt(n.subarray(2)),{d:s,l:a}=_e._parseInt(i);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s}},hexFromSig(e){const t=l=>Number.parseInt(l[0],16)&8?"00"+l:l,n=l=>{const f=l.toString(16);return f.length&1?`0${f}`:f},r=t(n(e.s)),o=t(n(e.r)),i=r.length/2,s=o.length/2,a=n(i),c=n(s);return`30${n(s+i+4)}02${c}${o}02${a}${r}`}},ie=BigInt(0),J=BigInt(1);BigInt(2);const Wn=BigInt(3);BigInt(4);function rs(e){const t=es(e),{Fp:n}=t,r=t.toBytes||((w,d,p)=>{const g=d.toAffine();return Te(Uint8Array.from([4]),n.toBytes(g.x),n.toBytes(g.y))}),o=t.fromBytes||(w=>{const d=w.subarray(1),p=n.fromBytes(d.subarray(0,n.BYTES)),g=n.fromBytes(d.subarray(n.BYTES,2*n.BYTES));return{x:p,y:g}});function i(w){const{a:d,b:p}=t,g=n.sqr(w),A=n.mul(g,w);return n.add(n.add(A,n.mul(w,d)),p)}if(!n.eql(n.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function s(w){return typeof w=="bigint"&&ie<w&&w<t.n}function a(w){if(!s(w))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(w){const{allowedPrivateKeyLengths:d,nByteLength:p,wrapPrivateKey:g,n:A}=t;if(d&&typeof w!="bigint"){if(w instanceof Uint8Array&&(w=Ce(w)),typeof w!="string"||!d.includes(w.length))throw new Error("Invalid key");w=w.padStart(p*2,"0")}let m;try{m=typeof w=="bigint"?w:F(V("private key",w,p))}catch{throw new Error(`private key must be ${p} bytes, hex or bigint, not ${typeof w}`)}return g&&(m=z(m,A)),a(m),m}const l=new Map;function f(w){if(!(w instanceof u))throw new Error("ProjectivePoint expected")}class u{constructor(d,p,g){if(this.px=d,this.py=p,this.pz=g,d==null||!n.isValid(d))throw new Error("x required");if(p==null||!n.isValid(p))throw new Error("y required");if(g==null||!n.isValid(g))throw new Error("z required")}static fromAffine(d){const{x:p,y:g}=d||{};if(!d||!n.isValid(p)||!n.isValid(g))throw new Error("invalid affine point");if(d instanceof u)throw new Error("projective point not allowed");const A=m=>n.eql(m,n.ZERO);return A(p)&&A(g)?u.ZERO:new u(p,g,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){const p=n.invertBatch(d.map(g=>g.pz));return d.map((g,A)=>g.toAffine(p[A])).map(u.fromAffine)}static fromHex(d){const p=u.fromAffine(o(V("pointHex",d)));return p.assertValidity(),p}static fromPrivateKey(d){return u.BASE.multiply(c(d))}_setWindowSize(d){this._WINDOW_SIZE=d,l.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:d,y:p}=this.toAffine();if(!n.isValid(d)||!n.isValid(p))throw new Error("bad point: x or y not FE");const g=n.sqr(p),A=i(d);if(!n.eql(g,A))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:d}=this.toAffine();if(n.isOdd)return!n.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){f(d);const{px:p,py:g,pz:A}=this,{px:m,py:S,pz:B}=d,x=n.eql(n.mul(p,B),n.mul(m,A)),E=n.eql(n.mul(g,B),n.mul(S,A));return x&&E}negate(){return new u(this.px,n.neg(this.py),this.pz)}double(){const{a:d,b:p}=t,g=n.mul(p,Wn),{px:A,py:m,pz:S}=this;let B=n.ZERO,x=n.ZERO,E=n.ZERO,_=n.mul(A,A),O=n.mul(m,m),R=n.mul(S,S),L=n.mul(A,m);return L=n.add(L,L),E=n.mul(A,S),E=n.add(E,E),B=n.mul(d,E),x=n.mul(g,R),x=n.add(B,x),B=n.sub(O,x),x=n.add(O,x),x=n.mul(B,x),B=n.mul(L,B),E=n.mul(g,E),R=n.mul(d,R),L=n.sub(_,R),L=n.mul(d,L),L=n.add(L,E),E=n.add(_,_),_=n.add(E,_),_=n.add(_,R),_=n.mul(_,L),x=n.add(x,_),R=n.mul(m,S),R=n.add(R,R),_=n.mul(R,L),B=n.sub(B,_),E=n.mul(R,O),E=n.add(E,E),E=n.add(E,E),new u(B,x,E)}add(d){f(d);const{px:p,py:g,pz:A}=this,{px:m,py:S,pz:B}=d;let x=n.ZERO,E=n.ZERO,_=n.ZERO;const O=t.a,R=n.mul(t.b,Wn);let L=n.mul(p,m),H=n.mul(g,S),P=n.mul(A,B),W=n.add(p,g),b=n.add(m,S);W=n.mul(W,b),b=n.add(L,H),W=n.sub(W,b),b=n.add(p,A);let v=n.add(m,B);return b=n.mul(b,v),v=n.add(L,P),b=n.sub(b,v),v=n.add(g,A),x=n.add(S,B),v=n.mul(v,x),x=n.add(H,P),v=n.sub(v,x),_=n.mul(O,b),x=n.mul(R,P),_=n.add(x,_),x=n.sub(H,_),_=n.add(H,_),E=n.mul(x,_),H=n.add(L,L),H=n.add(H,L),P=n.mul(O,P),b=n.mul(R,b),H=n.add(H,P),P=n.sub(L,P),P=n.mul(O,P),b=n.add(b,P),L=n.mul(H,b),E=n.add(E,L),L=n.mul(v,b),x=n.mul(W,x),x=n.sub(x,L),L=n.mul(W,H),_=n.mul(v,_),_=n.add(_,L),new u(x,E,_)}subtract(d){return this.add(d.negate())}is0(){return this.equals(u.ZERO)}wNAF(d){return y.wNAFCached(this,l,d,p=>{const g=n.invertBatch(p.map(A=>A.pz));return p.map((A,m)=>A.toAffine(g[m])).map(u.fromAffine)})}multiplyUnsafe(d){const p=u.ZERO;if(d===ie)return p;if(a(d),d===J)return this;const{endo:g}=t;if(!g)return y.unsafeLadder(this,d);let{k1neg:A,k1:m,k2neg:S,k2:B}=g.splitScalar(d),x=p,E=p,_=this;for(;m>ie||B>ie;)m&J&&(x=x.add(_)),B&J&&(E=E.add(_)),_=_.double(),m>>=J,B>>=J;return A&&(x=x.negate()),S&&(E=E.negate()),E=new u(n.mul(E.px,g.beta),E.py,E.pz),x.add(E)}multiply(d){a(d);let p=d,g,A;const{endo:m}=t;if(m){const{k1neg:S,k1:B,k2neg:x,k2:E}=m.splitScalar(p);let{p:_,f:O}=this.wNAF(B),{p:R,f:L}=this.wNAF(E);_=y.constTimeNegate(S,_),R=y.constTimeNegate(x,R),R=new u(n.mul(R.px,m.beta),R.py,R.pz),g=_.add(R),A=O.add(L)}else{const{p:S,f:B}=this.wNAF(p);g=S,A=B}return u.normalizeZ([g,A])[0]}multiplyAndAddUnsafe(d,p,g){const A=u.BASE,m=(B,x)=>x===ie||x===J||!B.equals(A)?B.multiplyUnsafe(x):B.multiply(x),S=m(this,p).add(m(d,g));return S.is0()?void 0:S}toAffine(d){const{px:p,py:g,pz:A}=this,m=this.is0();d==null&&(d=m?n.ONE:n.inv(A));const S=n.mul(p,d),B=n.mul(g,d),x=n.mul(A,d);if(m)return{x:n.ZERO,y:n.ZERO};if(!n.eql(x,n.ONE))throw new Error("invZ was invalid");return{x:S,y:B}}isTorsionFree(){const{h:d,isTorsionFree:p}=t;if(d===J)return!0;if(p)return p(u,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:d,clearCofactor:p}=t;return d===J?this:p?p(u,this):this.multiplyUnsafe(t.h)}toRawBytes(d=!0){return this.assertValidity(),r(u,this,d)}toHex(d=!0){return Ce(this.toRawBytes(d))}}u.BASE=new u(t.Gx,t.Gy,n.ONE),u.ZERO=new u(n.ZERO,n.ONE,n.ZERO);const h=t.nBitLength,y=Qi(u,t.endo?Math.ceil(h/2):h);return{CURVE:t,ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:s}}function os(e){const t=vr(e);return Ge(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function is(e){const t=os(e),{Fp:n,n:r}=t,o=n.BYTES+1,i=2*n.BYTES+1;function s(b){return ie<b&&b<n.ORDER}function a(b){return z(b,r)}function c(b){return Mt(b,r)}const{ProjectivePoint:l,normPrivateKeyToScalar:f,weierstrassEquation:u,isWithinCurveOrder:h}=rs({...t,toBytes(b,v,T){const $=v.toAffine(),k=n.toBytes($.x),U=Te;return T?U(Uint8Array.from([v.hasEvenY()?2:3]),k):U(Uint8Array.from([4]),k,n.toBytes($.y))},fromBytes(b){const v=b.length,T=b[0],$=b.subarray(1);if(v===o&&(T===2||T===3)){const k=F($);if(!s(k))throw new Error("Point is not on curve");const U=u(k);let M=n.sqrt(U);const C=(M&J)===J;return(T&1)===1!==C&&(M=n.neg(M)),{x:k,y:M}}else if(v===i&&T===4){const k=n.fromBytes($.subarray(0,n.BYTES)),U=n.fromBytes($.subarray(n.BYTES,2*n.BYTES));return{x:k,y:U}}else throw new Error(`Point of length ${v} was invalid. Expected ${o} compressed bytes or ${i} uncompressed bytes`)}}),y=b=>Ce(Ee(b,t.nByteLength));function w(b){const v=r>>J;return b>v}function d(b){return w(b)?a(-b):b}const p=(b,v,T)=>F(b.slice(v,T));class g{constructor(v,T,$){this.r=v,this.s=T,this.recovery=$,this.assertValidity()}static fromCompact(v){const T=t.nByteLength;return v=V("compactSignature",v,T*2),new g(p(v,0,T),p(v,T,2*T))}static fromDER(v){const{r:T,s:$}=_e.toSig(V("DER",v));return new g(T,$)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(v){return new g(this.r,this.s,v)}recoverPublicKey(v){const{r:T,s:$,recovery:k}=this,U=E(V("msgHash",v));if(k==null||![0,1,2,3].includes(k))throw new Error("recovery id invalid");const M=k===2||k===3?T+t.n:T;if(M>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const C=(k&1)===0?"02":"03",Y=l.fromHex(C+y(M)),de=c(M),Le=a(-U*de),We=a($*de),he=l.BASE.multiplyAndAddUnsafe(Y,Le,We);if(!he)throw new Error("point at infinify");return he.assertValidity(),he}hasHighS(){return w(this.s)}normalizeS(){return this.hasHighS()?new g(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Oe(this.toDERHex())}toDERHex(){return _e.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Oe(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}const A={isValidPrivateKey(b){try{return f(b),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const b=br(t.n);return Yi(t.randomBytes(b),t.n)},precompute(b=8,v=l.BASE){return v._setWindowSize(b),v.multiply(BigInt(3)),v}};function m(b,v=!0){return l.fromPrivateKey(b).toRawBytes(v)}function S(b){const v=b instanceof Uint8Array,T=typeof b=="string",$=(v||T)&&b.length;return v?$===o||$===i:T?$===2*o||$===2*i:b instanceof l}function B(b,v,T=!0){if(S(b))throw new Error("first arg must be private key");if(!S(v))throw new Error("second arg must be public key");return l.fromHex(v).multiply(f(b)).toRawBytes(T)}const x=t.bits2int||function(b){const v=F(b),T=b.length*8-t.nBitLength;return T>0?v>>BigInt(T):v},E=t.bits2int_modN||function(b){return a(x(b))},_=en(t.nBitLength);function O(b){if(typeof b!="bigint")throw new Error("bigint expected");if(!(ie<=b&&b<_))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Ee(b,t.nByteLength)}function R(b,v,T=L){if(["recovered","canonical"].some(xe=>xe in T))throw new Error("sign() legacy options not supported");const{hash:$,randomBytes:k}=t;let{lowS:U,prehash:M,extraEntropy:C}=T;U==null&&(U=!0),b=V("msgHash",b),M&&(b=V("prehashed msgHash",$(b)));const Y=E(b),de=f(v),Le=[O(de),O(Y)];if(C!=null){const xe=C===!0?k(n.BYTES):C;Le.push(V("extraEntropy",xe))}const We=Te(...Le),he=Y;function xt(xe){const ke=x(xe);if(!h(ke))return;const kn=c(ke),$e=l.BASE.multiply(ke).toAffine(),X=a($e.x);if(X===ie)return;const Re=a(kn*a(he+X*de));if(Re===ie)return;let $n=($e.x===X?0:2)|Number($e.y&J),Rn=Re;return U&&w(Re)&&(Rn=d(Re),$n^=1),new g(X,Rn,$n)}return{seed:We,k2sig:xt}}const L={lowS:t.lowS,prehash:!1},H={lowS:t.lowS,prehash:!1};function P(b,v,T=L){const{seed:$,k2sig:k}=R(b,v,T),U=t;return gr(U.hash.outputLen,U.nByteLength,U.hmac)($,k)}l.BASE._setWindowSize(8);function W(b,v,T,$=H){var $e;const k=b;if(v=V("msgHash",v),T=V("publicKey",T),"strict"in $)throw new Error("options.strict was renamed to lowS");const{lowS:U,prehash:M}=$;let C,Y;try{if(typeof k=="string"||k instanceof Uint8Array)try{C=g.fromDER(k)}catch(X){if(!(X instanceof _e.Err))throw X;C=g.fromCompact(k)}else if(typeof k=="object"&&typeof k.r=="bigint"&&typeof k.s=="bigint"){const{r:X,s:Re}=k;C=new g(X,Re)}else throw new Error("PARSE");Y=l.fromHex(T)}catch(X){if(X.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(U&&C.hasHighS())return!1;M&&(v=t.hash(v));const{r:de,s:Le}=C,We=E(v),he=c(Le),xt=a(We*he),xe=a(de*he),ke=($e=l.BASE.multiplyAndAddUnsafe(Y,xt,xe))==null?void 0:$e.toAffine();return ke?a(ke.x)===de:!1}return{CURVE:t,getPublicKey:m,getSharedSecret:B,sign:P,verify:W,ProjectivePoint:l,Signature:g,utils:A}}let Er=class extends fr{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,Ei(t);const r=Jt(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,i=new Uint8Array(o);i.set(r.length>o?t.create().update(r).digest():r);for(let s=0;s<i.length;s++)i[s]^=54;this.iHash.update(i),this.oHash=t.create();for(let s=0;s<i.length;s++)i[s]^=106;this.oHash.update(i),i.fill(0)}update(t){return et(this),this.iHash.update(t),this}digestInto(t){et(this),ur(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:o,destroyed:i,blockLen:s,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=i,t.blockLen=s,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const mr=(e,t,n)=>new Er(e,t).update(n).digest();mr.create=(e,t)=>new Er(e,t);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ss(e){return{hash:e,hmac:(t,...n)=>mr(e,t,Si(...n)),randomBytes:dr}}function as(e,t){const n=r=>is({...e,...ss(r)});return Object.freeze({...n(t),create:n})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ct=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),tt=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),xr=BigInt(1),nt=BigInt(2),jn=(e,t)=>(e+t/nt)/t;function Ar(e){const t=ct,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),l=e*e*e%t,f=l*l*e%t,u=G(f,n,t)*f%t,h=G(u,n,t)*f%t,y=G(h,nt,t)*l%t,w=G(y,o,t)*y%t,d=G(w,i,t)*w%t,p=G(d,a,t)*d%t,g=G(p,c,t)*p%t,A=G(g,a,t)*d%t,m=G(A,n,t)*f%t,S=G(m,s,t)*w%t,B=G(S,r,t)*l%t,x=G(B,nt,t);if(!qt.eql(qt.sqr(x),e))throw new Error("Cannot find square root");return x}const qt=Ji(ct,void 0,void 0,{sqrt:Ar}),Pe=as({a:BigInt(0),b:BigInt(7),Fp:qt,n:tt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=tt,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-xr*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,s=BigInt("0x100000000000000000000000000000000"),a=jn(i*e,t),c=jn(-r*e,t);let l=z(e-a*n-c*o,t),f=z(-a*r-c*i,t);const u=l>s,h=f>s;if(u&&(l=t-l),h&&(f=t-f),l>s||f>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:u,k1:l,k2neg:h,k2:f}}}},Ht),ut=BigInt(0),Sr=e=>typeof e=="bigint"&&ut<e&&e<ct,cs=e=>typeof e=="bigint"&&ut<e&&e<tt,Dn={};function rt(e,...t){let n=Dn[e];if(n===void 0){const r=Ht(Uint8Array.from(e,o=>o.charCodeAt(0)));n=Te(r,r),Dn[e]=n}return Ht(Te(n,...t))}const tn=e=>e.toRawBytes(!0).slice(1),Wt=e=>Ee(e,32),Lt=e=>z(e,ct),Ze=e=>z(e,tt),nn=Pe.ProjectivePoint,us=(e,t,n)=>nn.BASE.multiplyAndAddUnsafe(e,t,n);function jt(e){let t=Pe.utils.normPrivateKeyToScalar(e),n=nn.fromPrivateKey(t);return{scalar:n.hasEvenY()?t:Ze(-t),bytes:tn(n)}}function _r(e){if(!Sr(e))throw new Error("bad x: need 0 < x < p");const t=Lt(e*e),n=Lt(t*e+BigInt(7));let r=Ar(n);r%nt!==ut&&(r=Lt(-r));const o=new nn(e,r,xr);return o.assertValidity(),o}function Br(...e){return Ze(F(rt("BIP0340/challenge",...e)))}function ls(e){return jt(e).bytes}function fs(e,t,n=dr(32)){const r=V("message",e),{bytes:o,scalar:i}=jt(t),s=V("auxRand",n,32),a=Wt(i^F(rt("BIP0340/aux",s))),c=rt("BIP0340/nonce",a,o,r),l=Ze(F(c));if(l===ut)throw new Error("sign failed: k is zero");const{bytes:f,scalar:u}=jt(l),h=Br(f,o,r),y=new Uint8Array(64);if(y.set(f,0),y.set(Wt(Ze(u+h*i)),32),!Tr(y,r,o))throw new Error("sign: Invalid signature produced");return y}function Tr(e,t,n){const r=V("signature",e,64),o=V("message",t),i=V("publicKey",n,32);try{const s=_r(F(i)),a=F(r.subarray(0,32));if(!Sr(a))return!1;const c=F(r.subarray(32,64));if(!cs(c))return!1;const l=Br(Wt(a),tn(s),o),f=us(s,c,Ze(-l));return!(!f||!f.hasEvenY()||f.toAffine().x!==a)}catch{return!1}}const ze={getPublicKey:ls,sign:fs,verify:Tr,utils:{randomPrivateKey:Pe.utils.randomPrivateKey,lift_x:_r,pointToBytes:tn,numberToBytesBE:Ee,bytesToNumberBE:F,taggedHash:rt,mod:z}},kt=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const rn=e=>e instanceof Uint8Array,$t=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),te=(e,t)=>e<<32-t|e>>>t,ds=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!ds)throw new Error("Non little-endian hardware is not supported");const hs=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function K(e){if(!rn(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=hs[e[n]];return t}function Ie(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let r=0;r<n.length;r++){const o=r*2,i=e.slice(o,o+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");n[r]=s}return n}function ps(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Fe(e){if(typeof e=="string"&&(e=ps(e)),!rn(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function lt(...e){const t=new Uint8Array(e.reduce((r,o)=>r+o.length,0));let n=0;return e.forEach(r=>{if(!rn(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}class Ir{clone(){return this._cloneInto()}}function Lr(e){const t=r=>e().update(Fe(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function kr(e=32){if(kt&&typeof kt.getRandomValues=="function")return kt.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function Dt(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function gs(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function $r(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function ys(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Dt(e.outputLen),Dt(e.blockLen)}function ws(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function bs(e,t){$r(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const ne={number:Dt,bool:gs,bytes:$r,hash:ys,exists:ws,output:bs};function vs(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,l=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+l,a,r)}class Es extends Ir{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=$t(this.buffer)}update(t){ne.exists(this);const{view:n,buffer:r,blockLen:o}=this;t=Fe(t);const i=t.length;for(let s=0;s<i;){const a=Math.min(o-this.pos,i-s);if(a===o){const c=$t(t);for(;o<=i-s;s+=o)this.process(c,s);continue}r.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ne.exists(this),ne.output(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:i}=this;let{pos:s}=this;n[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>o-s&&(this.process(r,0),s=0);for(let u=s;u<o;u++)n[u]=0;vs(r,o-8,BigInt(this.length*8),i),this.process(r,0);const a=$t(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,f=this.get();if(l>f.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<l;u++)a.setUint32(4*u,f[u],i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:i,destroyed:s,pos:a}=this;return t.length=o,t.pos=a,t.finished=i,t.destroyed=s,o%n&&t.buffer.set(r),t}}const ms=(e,t,n)=>e&t^~e&n,xs=(e,t,n)=>e&t^e&n^t&n,As=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ye=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),we=new Uint32Array(64);class Rr extends Es{constructor(){super(64,32,8,!1),this.A=ye[0]|0,this.B=ye[1]|0,this.C=ye[2]|0,this.D=ye[3]|0,this.E=ye[4]|0,this.F=ye[5]|0,this.G=ye[6]|0,this.H=ye[7]|0}get(){const{A:t,B:n,C:r,D:o,E:i,F:s,G:a,H:c}=this;return[t,n,r,o,i,s,a,c]}set(t,n,r,o,i,s,a,c){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=a|0,this.H=c|0}process(t,n){for(let u=0;u<16;u++,n+=4)we[u]=t.getUint32(n,!1);for(let u=16;u<64;u++){const h=we[u-15],y=we[u-2],w=te(h,7)^te(h,18)^h>>>3,d=te(y,17)^te(y,19)^y>>>10;we[u]=d+we[u-7]+w+we[u-16]|0}let{A:r,B:o,C:i,D:s,E:a,F:c,G:l,H:f}=this;for(let u=0;u<64;u++){const h=te(a,6)^te(a,11)^te(a,25),y=f+h+ms(a,c,l)+As[u]+we[u]|0,d=(te(r,2)^te(r,13)^te(r,22))+xs(r,o,i)|0;f=l,l=c,c=a,a=s+y|0,s=i,i=o,o=r,r=y+d|0}r=r+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,f=f+this.H|0,this.set(r,o,i,s,a,c,l,f)}roundClean(){we.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Ss extends Rr{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Me=Lr(()=>new Rr);Lr(()=>new Ss);/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function qe(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function ue(...e){const t=(o,i)=>s=>o(i(s)),n=Array.from(e).reverse().reduce((o,i)=>o?t(o,i.encode):i.encode,void 0),r=e.reduce((o,i)=>o?t(o,i.decode):i.decode,void 0);return{encode:n,decode:r}}function le(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(n=>{if(qe(n),n<0||n>=e.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${e.length})`);return e[n]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);const r=e.indexOf(n);if(r===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${e}`);return r})}}}function fe(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of t)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function ft(e,t="="){if(qe(e),typeof t!="string")throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let r of n)if(typeof r!="string")throw new Error(`padding.encode: non-string input=${r}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let o of n)if(typeof o!="string")throw new Error(`padding.decode: non-string input=${o}`);let r=n.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function Ur(e){if(typeof e!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>e(t)}}function zn(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let r=0;const o=[],i=Array.from(e);for(i.forEach(s=>{if(qe(s),s<0||s>=t)throw new Error(`Wrong integer: ${s}`)});;){let s=0,a=!0;for(let c=r;c<i.length;c++){const l=i[c],f=t*s+l;if(!Number.isSafeInteger(f)||t*s/t!==s||f-l!==t*s)throw new Error("convertRadix: carry overflow");if(s=f%n,i[c]=Math.floor(f/n),!Number.isSafeInteger(i[c])||i[c]*n+s!==f)throw new Error("convertRadix: carry overflow");if(a)i[c]?a=!1:r=c;else continue}if(o.push(s),a)break}for(let s=0;s<e.length-1&&e[s]===0;s++)o.push(0);return o.reverse()}const Nr=(e,t)=>t?Nr(t,e%t):e,ot=(e,t)=>e+(t-Nr(e,t));function zt(e,t,n,r){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(ot(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${ot(t,n)}`);let o=0,i=0;const s=2**n-1,a=[];for(const c of e){if(qe(c),c>=2**t)throw new Error(`convertRadix2: invalid data word=${c} from=${t}`);if(o=o<<t|c,i+t>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${t}`);for(i+=t;i>=n;i-=n)a.push((o>>i-n&s)>>>0);o&=2**i-1}if(o=o<<n-i&s,!r&&i>=t)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&i>0&&a.push(o>>>0),a}function _s(e){return qe(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return zn(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(zn(t,e,2**8))}}}function me(e,t=!1){if(qe(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(ot(8,e)>32||ot(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return zt(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(zt(n,e,8,t))}}}function Vn(e){if(typeof e!="function")throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch{}}}const Bs=ue(me(4),le("0123456789ABCDEF"),fe("")),Ts=ue(me(5),le("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),ft(5),fe(""));ue(me(5),le("0123456789ABCDEFGHIJKLMNOPQRSTUV"),ft(5),fe(""));ue(me(5),le("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),fe(""),Ur(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const ce=ue(me(6),le("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),ft(6),fe("")),Is=ue(me(6),le("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),ft(6),fe("")),on=e=>ue(_s(58),le(e),fe("")),Vt=on("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");on("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");on("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const Kn=[0,2,3,5,6,7,9,10,11],Ls={encode(e){let t="";for(let n=0;n<e.length;n+=8){const r=e.subarray(n,n+8);t+=Vt.encode(r).padStart(Kn[r.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){const r=e.slice(n,n+11),o=Kn.indexOf(r.length),i=Vt.decode(r);for(let s=0;s<i.length-o;s++)if(i[s]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(i.slice(i.length-o)))}return Uint8Array.from(t)}},Kt=ue(le("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),fe("")),Zn=[996825010,642813549,513874426,1027748829,705979059];function Ve(e){const t=e>>25;let n=(e&33554431)<<5;for(let r=0;r<Zn.length;r++)(t>>r&1)===1&&(n^=Zn[r]);return n}function Fn(e,t,n=1){const r=e.length;let o=1;for(let i=0;i<r;i++){const s=e.charCodeAt(i);if(s<33||s>126)throw new Error(`Invalid prefix (${e})`);o=Ve(o)^s>>5}o=Ve(o);for(let i=0;i<r;i++)o=Ve(o)^e.charCodeAt(i)&31;for(let i of t)o=Ve(o)^i;for(let i=0;i<6;i++)o=Ve(o);return o^=n,Kt.encode(zt([o%2**30],30,5,!1))}function Cr(e){const t=e==="bech32"?1:734539939,n=me(5),r=n.decode,o=n.encode,i=Vn(r);function s(f,u,h=90){if(typeof f!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof f}`);if(!Array.isArray(u)||u.length&&typeof u[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof u}`);const y=f.length+7+u.length;if(h!==!1&&y>h)throw new TypeError(`Length ${y} exceeds limit ${h}`);return f=f.toLowerCase(),`${f}1${Kt.encode(u)}${Fn(f,u,t)}`}function a(f,u=90){if(typeof f!="string")throw new Error(`bech32.decode input should be string, not ${typeof f}`);if(f.length<8||u!==!1&&f.length>u)throw new TypeError(`Wrong string length: ${f.length} (${f}). Expected (8..${u})`);const h=f.toLowerCase();if(f!==h&&f!==f.toUpperCase())throw new Error("String must be lowercase or uppercase");f=h;const y=f.lastIndexOf("1");if(y===0||y===-1)throw new Error('Letter "1" must be present between prefix and data only');const w=f.slice(0,y),d=f.slice(y+1);if(d.length<6)throw new Error("Data must be at least 6 characters long");const p=Kt.decode(d).slice(0,-6),g=Fn(w,p,t);if(!d.endsWith(g))throw new Error(`Invalid checksum in ${f}: expected "${g}"`);return{prefix:w,words:p}}const c=Vn(a);function l(f){const{prefix:u,words:h}=a(f,!1);return{prefix:u,words:h,bytes:r(h)}}return{encode:s,decode:a,decodeToBytes:l,decodeUnsafe:c,fromWords:r,fromWordsUnsafe:i,toWords:o}}const He=Cr("bech32");Cr("bech32m");const ks={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)},$s=ue(me(4),le("0123456789abcdef"),fe(""),Ur(e=>{if(typeof e!="string"||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),Rs={utf8:ks,hex:$s,base16:Bs,base32:Ts,base64:ce,base64url:Is,base58:Vt,base58xmr:Ls};`${Object.keys(Rs).join(", ")}`;function Rt(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function Gn(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function Us(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function se(e,...t){if(!Us(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const Z=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Ns=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ns)throw new Error("Non little-endian hardware is not supported");function Cs(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function Os(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}const Hs=(e,t)=>(Object.assign(t,e),t),ve=16,Ps=283;function sn(e){return e<<1^Ps&-(e>>7)}function Ue(e,t){let n=0;for(;t>0;t>>=1)n^=e&-(t&1),e=sn(e);return n}const Zt=(()=>{let e=new Uint8Array(256);for(let n=0,r=1;n<256;n++,r^=sn(r))e[n]=r;const t=new Uint8Array(256);t[0]=99;for(let n=0;n<255;n++){let r=e[255-n];r|=r<<8,t[e[n]]=(r^r>>4^r>>5^r>>6^r>>7^99)&255}return t})(),Ms=Zt.map((e,t)=>Zt.indexOf(t)),qs=e=>e<<24|e>>>8,Ut=e=>e<<8|e>>>24;function Or(e,t){if(e.length!==256)throw new Error("Wrong sbox length");const n=new Uint32Array(256).map((l,f)=>t(e[f])),r=n.map(Ut),o=r.map(Ut),i=o.map(Ut),s=new Uint32Array(256*256),a=new Uint32Array(256*256),c=new Uint16Array(256*256);for(let l=0;l<256;l++)for(let f=0;f<256;f++){const u=l*256+f;s[u]=n[l]^r[f],a[u]=o[l]^i[f],c[u]=e[l]<<8|e[f]}return{sbox:e,sbox2:c,T0:n,T1:r,T2:o,T3:i,T01:s,T23:a}}const an=Or(Zt,e=>Ue(e,3)<<24|e<<16|e<<8|Ue(e,2)),Hr=Or(Ms,e=>Ue(e,11)<<24|Ue(e,13)<<16|Ue(e,9)<<8|Ue(e,14)),Ws=(()=>{const e=new Uint8Array(16);for(let t=0,n=1;t<16;t++,n=sn(n))e[t]=n;return e})();function Pr(e){se(e);const t=e.length;if(![16,24,32].includes(t))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${t}`);const{sbox2:n}=an,r=Z(e),o=r.length,i=a=>re(n,a,a,a,a),s=new Uint32Array(t+28);s.set(r);for(let a=o;a<s.length;a++){let c=s[a-1];a%o===0?c=i(qs(c))^Ws[a/o-1]:o>6&&a%o===4&&(c=i(c)),s[a]=s[a-o]^c}return s}function js(e){const t=Pr(e),n=t.slice(),r=t.length,{sbox2:o}=an,{T0:i,T1:s,T2:a,T3:c}=Hr;for(let l=0;l<r;l+=4)for(let f=0;f<4;f++)n[l+f]=t[r-l-4+f];t.fill(0);for(let l=4;l<r-4;l++){const f=n[l],u=re(o,f,f,f,f);n[l]=i[u&255]^s[u>>>8&255]^a[u>>>16&255]^c[u>>>24]}return n}function be(e,t,n,r,o,i){return e[n<<8&65280|r>>>8&255]^t[o>>>8&65280|i>>>24&255]}function re(e,t,n,r,o){return e[t&255|n&65280]|e[r>>>16&255|o>>>16&65280]<<16}function Jn(e,t,n,r,o){const{sbox2:i,T01:s,T23:a}=an;let c=0;t^=e[c++],n^=e[c++],r^=e[c++],o^=e[c++];const l=e.length/4-2;for(let w=0;w<l;w++){const d=e[c++]^be(s,a,t,n,r,o),p=e[c++]^be(s,a,n,r,o,t),g=e[c++]^be(s,a,r,o,t,n),A=e[c++]^be(s,a,o,t,n,r);t=d,n=p,r=g,o=A}const f=e[c++]^re(i,t,n,r,o),u=e[c++]^re(i,n,r,o,t),h=e[c++]^re(i,r,o,t,n),y=e[c++]^re(i,o,t,n,r);return{s0:f,s1:u,s2:h,s3:y}}function Ds(e,t,n,r,o){const{sbox2:i,T01:s,T23:a}=Hr;let c=0;t^=e[c++],n^=e[c++],r^=e[c++],o^=e[c++];const l=e.length/4-2;for(let w=0;w<l;w++){const d=e[c++]^be(s,a,t,o,r,n),p=e[c++]^be(s,a,n,t,o,r),g=e[c++]^be(s,a,r,n,t,o),A=e[c++]^be(s,a,o,r,n,t);t=d,n=p,r=g,o=A}const f=e[c++]^re(i,t,o,r,n),u=e[c++]^re(i,n,t,o,r),h=e[c++]^re(i,r,n,t,o),y=e[c++]^re(i,o,r,n,t);return{s0:f,s1:u,s2:h,s3:y}}function Mr(e,t){if(!t)return new Uint8Array(e);if(se(t),t.length<e)throw new Error(`aes: wrong destination length, expected at least ${e}, got: ${t.length}`);return t}function zs(e){if(se(e),e.length%ve!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${ve}`)}function Vs(e,t,n){let r=e.length;const o=r%ve;if(!t&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const i=Z(e);if(t){let c=ve-o;c||(c=ve),r=r+c}const s=Mr(r,n),a=Z(s);return{b:i,o:a,out:s}}function Ks(e,t){if(!t)return e;const n=e.length;if(!n)throw new Error("aes/pcks5: empty ciphertext not allowed");const r=e[n-1];if(r<=0||r>16)throw new Error(`aes/pcks5: wrong padding byte: ${r}`);const o=e.subarray(0,-r);for(let i=0;i<r;i++)if(e[n-i-1]!==r)throw new Error("aes/pcks5: wrong padding");return o}function Zs(e){const t=new Uint8Array(16),n=Z(t);t.set(e);const r=ve-e.length;for(let o=ve-r;o<ve;o++)t[o]=r;return n}const qr=Hs({blockSize:16,nonceLength:16},function(t,n,r={}){se(t),se(n,16);const o=!r.disablePadding;return{encrypt:(i,s)=>{const a=Pr(t),{b:c,o:l,out:f}=Vs(i,o,s),u=Z(n);let h=u[0],y=u[1],w=u[2],d=u[3],p=0;for(;p+4<=c.length;)h^=c[p+0],y^=c[p+1],w^=c[p+2],d^=c[p+3],{s0:h,s1:y,s2:w,s3:d}=Jn(a,h,y,w,d),l[p++]=h,l[p++]=y,l[p++]=w,l[p++]=d;if(o){const g=Zs(i.subarray(p*4));h^=g[0],y^=g[1],w^=g[2],d^=g[3],{s0:h,s1:y,s2:w,s3:d}=Jn(a,h,y,w,d),l[p++]=h,l[p++]=y,l[p++]=w,l[p++]=d}return a.fill(0),f},decrypt:(i,s)=>{zs(i);const a=js(t),c=Z(n),l=Mr(i.length,s),f=Z(i),u=Z(l);let h=c[0],y=c[1],w=c[2],d=c[3];for(let p=0;p+4<=f.length;){const g=h,A=y,m=w,S=d;h=f[p+0],y=f[p+1],w=f[p+2],d=f[p+3];const{s0:B,s1:x,s2:E,s3:_}=Ds(a,h,y,w,d);u[p++]=B^g,u[p++]=x^A,u[p++]=E^m,u[p++]=_^S}return a.fill(0),Ks(l,o)}}}),Wr=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),Fs=Wr("expand 16-byte k"),Gs=Wr("expand 32-byte k"),Js=Z(Fs),jr=Z(Gs);jr.slice();function N(e,t){return e<<t|e>>>32-t}function Ft(e){return e.byteOffset%4===0}const Je=64,Ys=16,Dr=2**32-1,Yn=new Uint32Array;function Xs(e,t,n,r,o,i,s,a){const c=o.length,l=new Uint8Array(Je),f=Z(l),u=Ft(o)&&Ft(i),h=u?Z(o):Yn,y=u?Z(i):Yn;for(let w=0;w<c;s++){if(e(t,n,r,f,s,a),s>=Dr)throw new Error("arx: counter overflow");const d=Math.min(Je,c-w);if(u&&d===Je){const p=w/4;if(w%4!==0)throw new Error("arx: invalid block position");for(let g=0,A;g<Ys;g++)A=p+g,y[A]=h[A]^f[g];w+=Je;continue}for(let p=0,g;p<d;p++)g=w+p,i[g]=o[g]^l[p];w+=d}}function Qs(e,t){const{allowShortKeys:n,extendNonceFn:r,counterLength:o,counterRight:i,rounds:s}=Cs({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return Rt(o),Rt(s),Gn(i),Gn(n),(a,c,l,f,u=0)=>{se(a),se(c),se(l);const h=l.length;if(f||(f=new Uint8Array(h)),se(f),Rt(u),u<0||u>=Dr)throw new Error("arx: counter overflow");if(f.length<h)throw new Error(`arx: output (${f.length}) is shorter than data (${h})`);const y=[];let w=a.length,d,p;if(w===32)d=a.slice(),y.push(d),p=jr;else if(w===16&&n)d=new Uint8Array(32),d.set(a),d.set(a,16),p=Js,y.push(d);else throw new Error(`arx: invalid 32-byte key, got length=${w}`);Ft(c)||(c=c.slice(),y.push(c));const g=Z(d);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(p,g,Z(c.subarray(0,16)),g),c=c.subarray(16)}const A=16-o;if(A!==c.length)throw new Error(`arx: nonce must be ${A} or 16 bytes`);if(A!==12){const S=new Uint8Array(12);S.set(c,i?0:12-c.length),c=S,y.push(c)}const m=Z(c);for(Xs(e,p,g,m,l,f,u,s);y.length>0;)y.pop().fill(0);return f}}function ea(e,t,n,r,o,i=20){let s=e[0],a=e[1],c=e[2],l=e[3],f=t[0],u=t[1],h=t[2],y=t[3],w=t[4],d=t[5],p=t[6],g=t[7],A=o,m=n[0],S=n[1],B=n[2],x=s,E=a,_=c,O=l,R=f,L=u,H=h,P=y,W=w,b=d,v=p,T=g,$=A,k=m,U=S,M=B;for(let Y=0;Y<i;Y+=2)x=x+R|0,$=N($^x,16),W=W+$|0,R=N(R^W,12),x=x+R|0,$=N($^x,8),W=W+$|0,R=N(R^W,7),E=E+L|0,k=N(k^E,16),b=b+k|0,L=N(L^b,12),E=E+L|0,k=N(k^E,8),b=b+k|0,L=N(L^b,7),_=_+H|0,U=N(U^_,16),v=v+U|0,H=N(H^v,12),_=_+H|0,U=N(U^_,8),v=v+U|0,H=N(H^v,7),O=O+P|0,M=N(M^O,16),T=T+M|0,P=N(P^T,12),O=O+P|0,M=N(M^O,8),T=T+M|0,P=N(P^T,7),x=x+L|0,M=N(M^x,16),v=v+M|0,L=N(L^v,12),x=x+L|0,M=N(M^x,8),v=v+M|0,L=N(L^v,7),E=E+H|0,$=N($^E,16),T=T+$|0,H=N(H^T,12),E=E+H|0,$=N($^E,8),T=T+$|0,H=N(H^T,7),_=_+P|0,k=N(k^_,16),W=W+k|0,P=N(P^W,12),_=_+P|0,k=N(k^_,8),W=W+k|0,P=N(P^W,7),O=O+R|0,U=N(U^O,16),b=b+U|0,R=N(R^b,12),O=O+R|0,U=N(U^O,8),b=b+U|0,R=N(R^b,7);let C=0;r[C++]=s+x|0,r[C++]=a+E|0,r[C++]=c+_|0,r[C++]=l+O|0,r[C++]=f+R|0,r[C++]=u+L|0,r[C++]=h+H|0,r[C++]=y+P|0,r[C++]=w+W|0,r[C++]=d+b|0,r[C++]=p+v|0,r[C++]=g+T|0,r[C++]=A+$|0,r[C++]=m+k|0,r[C++]=S+U|0,r[C++]=B+M|0}const zr=Qs(ea,{counterRight:!1,counterLength:4,allowShortKeys:!1});class Vr extends Ir{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,ne.hash(t);const r=Fe(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,i=new Uint8Array(o);i.set(r.length>o?t.create().update(r).digest():r);for(let s=0;s<i.length;s++)i[s]^=54;this.iHash.update(i),this.oHash=t.create();for(let s=0;s<i.length;s++)i[s]^=106;this.oHash.update(i),i.fill(0)}update(t){return ne.exists(this),this.iHash.update(t),this}digestInto(t){ne.exists(this),ne.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:o,destroyed:i,blockLen:s,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=i,t.blockLen=s,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const dt=(e,t,n)=>new Vr(e,t).update(n).digest();dt.create=(e,t)=>new Vr(e,t);function ta(e,t,n){return ne.hash(e),dt(e,Fe(n),Fe(t))}const Nt=new Uint8Array([0]),Xn=new Uint8Array;function na(e,t,n,r=32){if(ne.hash(e),ne.number(r),r>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(r/e.outputLen);n===void 0&&(n=Xn);const i=new Uint8Array(o*e.outputLen),s=dt.create(e,t),a=s._cloneInto(),c=new Uint8Array(s.outputLen);for(let l=0;l<o;l++)Nt[0]=l+1,a.update(l===0?Xn:c).update(n).update(Nt).digestInto(c),i.set(c,e.outputLen*l),s._cloneInto(a);return s.destroy(),a.destroy(),c.fill(0),Nt.fill(0),i.slice(0,r)}var ra=Object.defineProperty,q=(e,t)=>{for(var n in t)ra(e,n,{get:t[n],enumerable:!0})},Ae=Symbol("verified"),oa=e=>e instanceof Object;function cn(e){if(!oa(e)||typeof e.kind!="number"||typeof e.content!="string"||typeof e.created_at!="number"||typeof e.pubkey!="string"||!e.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let n=e.tags[t];if(!Array.isArray(n))return!1;for(let r=0;r<n.length;r++)if(typeof n[r]!="string")return!1}return!0}var ia={};q(ia,{Queue:()=>Zr,QueueNode:()=>Kr,binarySearch:()=>un,bytesToHex:()=>K,hexToBytes:()=>Ie,insertEventIntoAscendingList:()=>aa,insertEventIntoDescendingList:()=>sa,normalizeURL:()=>Ne,utf8Decoder:()=>ae,utf8Encoder:()=>Q});var ae=new TextDecoder("utf-8"),Q=new TextEncoder;function Ne(e){try{e.indexOf("://")===-1&&(e="wss://"+e);let t=new URL(e);return t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),(t.port==="80"&&t.protocol==="ws:"||t.port==="443"&&t.protocol==="wss:")&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}catch{throw new Error(`Invalid URL: ${e}`)}}function sa(e,t){const[n,r]=un(e,o=>t.id===o.id?0:t.created_at===o.created_at?-1:o.created_at-t.created_at);return r||e.splice(n,0,t),e}function aa(e,t){const[n,r]=un(e,o=>t.id===o.id?0:t.created_at===o.created_at?-1:t.created_at-o.created_at);return r||e.splice(n,0,t),e}function un(e,t){let n=0,r=e.length-1;for(;n<=r;){const o=Math.floor((n+r)/2),i=t(e[o]);if(i===0)return[o,!0];i<0?r=o-1:n=o+1}return[n,!1]}var Kr=class{constructor(e){I(this,"value");I(this,"next",null);I(this,"prev",null);this.value=e}},Zr=class{constructor(){I(this,"first");I(this,"last");this.first=null,this.last=null}enqueue(e){const t=new Kr(e);return this.last?this.last===this.first?(this.last=t,this.last.prev=this.first,this.first.next=t):(t.prev=this.last,this.last.next=t,this.last=t):(this.first=t,this.last=t),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const t=this.first;return this.first=null,this.last=null,t.value}const e=this.first;return this.first=e.next,this.first&&(this.first.prev=null),e.value}},ca=class{generateSecretKey(){return ze.utils.randomPrivateKey()}getPublicKey(e){return K(ze.getPublicKey(e))}finalizeEvent(e,t){const n=e;return n.pubkey=K(ze.getPublicKey(t)),n.id=Ye(n),n.sig=K(ze.sign(Ye(n),t)),n[Ae]=!0,n}verifyEvent(e){if(typeof e[Ae]=="boolean")return e[Ae];const t=Ye(e);if(t!==e.id)return e[Ae]=!1,!1;try{const n=ze.verify(e.sig,t,e.pubkey);return e[Ae]=n,n}catch{return e[Ae]=!1,!1}}};function ua(e){if(!cn(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function Ye(e){let t=Me(Q.encode(ua(e)));return K(t)}var ht=new ca,la=ht.generateSecretKey,ln=ht.getPublicKey,oe=ht.finalizeEvent,pt=ht.verifyEvent,fa={};q(fa,{Application:()=>fc,BadgeAward:()=>Ea,BadgeDefinition:()=>oc,BlockedRelaysList:()=>ja,BookmarkList:()=>Ma,Bookmarksets:()=>tc,Calendar:()=>bc,CalendarEventRSVP:()=>vc,ChannelCreation:()=>Qr,ChannelHideMessage:()=>no,ChannelMessage:()=>to,ChannelMetadata:()=>eo,ChannelMuteUser:()=>ro,ClassifiedListing:()=>pc,ClientAuth:()=>io,CommunitiesList:()=>qa,CommunityDefinition:()=>xc,CommunityPostApproval:()=>Ia,Contacts:()=>wa,CreateOrUpdateProduct:()=>ac,CreateOrUpdateStall:()=>sc,Curationsets:()=>nc,Date:()=>yc,DirectMessageRelaysList:()=>Ka,DraftClassifiedListing:()=>gc,DraftLong:()=>uc,Emojisets:()=>lc,EncryptedDirectMessage:()=>ba,EventDeletion:()=>va,FileMetadata:()=>xa,FileServerPreference:()=>Za,Followsets:()=>Xa,GenericRepost:()=>pn,Genericlists:()=>Qa,GiftWrap:()=>oo,HTTPAuth:()=>gn,Handlerinformation:()=>mc,Handlerrecommendation:()=>Ec,Highlights:()=>Ca,InterestsList:()=>za,Interestsets:()=>ic,JobFeedback:()=>$a,JobRequest:()=>La,JobResult:()=>ka,Label:()=>Ta,LightningPubRPC:()=>Ga,LiveChatMessage:()=>Aa,LiveEvent:()=>dc,LongFormArticle:()=>cc,Metadata:()=>ga,Mutelist:()=>Oa,NWCWalletInfo:()=>Fa,NWCWalletRequest:()=>so,NWCWalletResponse:()=>Ja,NostrConnect:()=>Ya,OpenTimestamps:()=>ma,Pinlist:()=>Ha,PrivateDirectMessage:()=>Xr,ProblemTracker:()=>Sa,ProfileBadges:()=>rc,PublicChatsList:()=>Wa,Reaction:()=>hn,RecommendRelay:()=>ya,RelayList:()=>Pa,Relaysets:()=>ec,Report:()=>_a,Reporting:()=>Ba,Repost:()=>dn,Seal:()=>Yr,SearchRelaysList:()=>Da,ShortTextNote:()=>Jr,Time:()=>wc,UserEmojiList:()=>Va,UserStatuses:()=>hc,Zap:()=>Na,ZapGoal:()=>Ra,ZapRequest:()=>Ua,classifyKind:()=>ha,isAddressableKind:()=>gt,isEphemeralKind:()=>Gr,isKind:()=>pa,isParameterizedReplaceableKind:()=>da,isRegularKind:()=>Fr,isReplaceableKind:()=>fn});function Fr(e){return 1e3<=e&&e<1e4||[1,2,4,5,6,7,8,16,40,41,42,43,44].includes(e)}function fn(e){return[0,3].includes(e)||1e4<=e&&e<2e4}function Gr(e){return 2e4<=e&&e<3e4}function gt(e){return 3e4<=e&&e<4e4}var da=gt;function ha(e){return Fr(e)?"regular":fn(e)?"replaceable":Gr(e)?"ephemeral":gt(e)?"parameterized":"unknown"}function pa(e,t){const n=t instanceof Array?t:[t];return cn(e)&&n.includes(e.kind)||!1}var ga=0,Jr=1,ya=2,wa=3,ba=4,va=5,dn=6,hn=7,Ea=8,Yr=13,Xr=14,pn=16,Qr=40,eo=41,to=42,no=43,ro=44,ma=1040,oo=1059,xa=1063,Aa=1311,Sa=1971,_a=1984,Ba=1984,Ta=1985,Ia=4550,La=5999,ka=6999,$a=7e3,Ra=9041,Ua=9734,Na=9735,Ca=9802,Oa=1e4,Ha=10001,Pa=10002,Ma=10003,qa=10004,Wa=10005,ja=10006,Da=10007,za=10015,Va=10030,Ka=10050,Za=10096,Fa=13194,Ga=21e3,io=22242,so=23194,Ja=23195,Ya=24133,gn=27235,Xa=3e4,Qa=30001,ec=30002,tc=30003,nc=30004,rc=30008,oc=30009,ic=30015,sc=30017,ac=30018,cc=30023,uc=30024,lc=30030,fc=30078,dc=30311,hc=30315,pc=30402,gc=30403,yc=31922,wc=31923,bc=31924,vc=31925,Ec=31989,mc=31990,xc=34550;function Ac(e,t){if(e.ids&&e.ids.indexOf(t.id)===-1||e.kinds&&e.kinds.indexOf(t.kind)===-1||e.authors&&e.authors.indexOf(t.pubkey)===-1)return!1;for(let n in e)if(n[0]==="#"){let r=n.slice(1),o=e[`#${r}`];if(o&&!t.tags.find(([i,s])=>i===n.slice(1)&&o.indexOf(s)!==-1))return!1}return!(e.since&&t.created_at<e.since||e.until&&t.created_at>e.until)}function Sc(e,t){for(let n=0;n<e.length;n++)if(Ac(e[n],t))return!0;return!1}var _c={};q(_c,{getHex64:()=>yt,getInt:()=>ao,getSubscriptionId:()=>co,matchEventId:()=>Bc,matchEventKind:()=>Ic,matchEventPubkey:()=>Tc});function yt(e,t){let n=t.length+3,r=e.indexOf(`"${t}":`)+n,o=e.slice(r).indexOf('"')+r+1;return e.slice(o,o+64)}function ao(e,t){let n=t.length,r=e.indexOf(`"${t}":`)+n+3,o=e.slice(r),i=Math.min(o.indexOf(","),o.indexOf("}"));return parseInt(o.slice(0,i),10)}function co(e){let t=e.slice(0,22).indexOf('"EVENT"');if(t===-1)return null;let n=e.slice(t+7+1).indexOf('"');if(n===-1)return null;let r=t+7+1+n,o=e.slice(r+1,80).indexOf('"');if(o===-1)return null;let i=r+1+o;return e.slice(r+1,i)}function Bc(e,t){return t===yt(e,"id")}function Tc(e,t){return t===yt(e,"pubkey")}function Ic(e,t){return t===ao(e,"kind")}var Lc={};q(Lc,{makeAuthEvent:()=>uo});function uo(e,t){return{kind:io,created_at:Math.floor(Date.now()/1e3),tags:[["relay",e],["challenge",t]],content:""}}async function kc(){return new Promise(e=>{const t=new MessageChannel,n=()=>{t.port1.removeEventListener("message",n),e()};t.port1.addEventListener("message",n),t.port2.postMessage(0),t.port1.start()})}var $c=e=>(e[Ae]=!0,!0),lo=class{constructor(e,t){I(this,"url");I(this,"_connected",!1);I(this,"onclose",null);I(this,"onnotice",e=>console.debug(`NOTICE from ${this.url}: ${e}`));I(this,"_onauth",null);I(this,"baseEoseTimeout",4400);I(this,"connectionTimeout",4400);I(this,"publishTimeout",4400);I(this,"openSubs",new Map);I(this,"connectionTimeoutHandle");I(this,"connectionPromise");I(this,"openCountRequests",new Map);I(this,"openEventPublishes",new Map);I(this,"ws");I(this,"incomingMessageQueue",new Zr);I(this,"queueRunning",!1);I(this,"challenge");I(this,"authPromise");I(this,"serial",0);I(this,"verifyEvent");I(this,"_WebSocket");this.url=Ne(e),this.verifyEvent=t.verifyEvent,this._WebSocket=t.websocketImplementation||WebSocket}static async connect(e,t){const n=new lo(e,t);return await n.connect(),n}closeAllSubscriptions(e){for(let[t,n]of this.openSubs)n.close(e);this.openSubs.clear();for(let[t,n]of this.openEventPublishes)n.reject(new Error(e));this.openEventPublishes.clear();for(let[t,n]of this.openCountRequests)n.reject(new Error(e));this.openCountRequests.clear()}get connected(){return this._connected}async connect(){return this.connectionPromise?this.connectionPromise:(this.challenge=void 0,this.authPromise=void 0,this.connectionPromise=new Promise((e,t)=>{this.connectionTimeoutHandle=setTimeout(()=>{var n;t("connection timed out"),this.connectionPromise=void 0,(n=this.onclose)==null||n.call(this),this.closeAllSubscriptions("relay connection timed out")},this.connectionTimeout);try{this.ws=new this._WebSocket(this.url)}catch(n){clearTimeout(this.connectionTimeoutHandle),t(n);return}this.ws.onopen=()=>{clearTimeout(this.connectionTimeoutHandle),this._connected=!0,e()},this.ws.onerror=n=>{var r;clearTimeout(this.connectionTimeoutHandle),t(n.message||"websocket error"),this._connected&&(this._connected=!1,this.connectionPromise=void 0,(r=this.onclose)==null||r.call(this),this.closeAllSubscriptions("relay connection errored"))},this.ws.onclose=n=>{var r;clearTimeout(this.connectionTimeoutHandle),t(n.message||"websocket closed"),this._connected&&(this._connected=!1,this.connectionPromise=void 0,(r=this.onclose)==null||r.call(this),this.closeAllSubscriptions("relay connection closed"))},this.ws.onmessage=this._onmessage.bind(this)}),this.connectionPromise)}async runQueue(){for(this.queueRunning=!0;this.handleNext()!==!1;)await kc();this.queueRunning=!1}handleNext(){var n,r,o;const e=this.incomingMessageQueue.dequeue();if(!e)return!1;const t=co(e);if(t){const i=this.openSubs.get(t);if(!i)return;const s=yt(e,"id"),a=(n=i.alreadyHaveEvent)==null?void 0:n.call(i,s);if((r=i.receivedEvent)==null||r.call(i,this,s),a)return}try{let i=JSON.parse(e);switch(i[0]){case"EVENT":{const s=this.openSubs.get(i[1]),a=i[2];this.verifyEvent(a)&&Sc(s.filters,a)&&s.onevent(a);return}case"COUNT":{const s=i[1],a=i[2],c=this.openCountRequests.get(s);c&&(c.resolve(a.count),this.openCountRequests.delete(s));return}case"EOSE":{const s=this.openSubs.get(i[1]);if(!s)return;s.receivedEose();return}case"OK":{const s=i[1],a=i[2],c=i[3],l=this.openEventPublishes.get(s);l&&(clearTimeout(l.timeout),a?l.resolve(c):l.reject(new Error(c)),this.openEventPublishes.delete(s));return}case"CLOSED":{const s=i[1],a=this.openSubs.get(s);if(!a)return;a.closed=!0,a.close(i[2]);return}case"NOTICE":this.onnotice(i[1]);return;case"AUTH":{this.challenge=i[1],(o=this._onauth)==null||o.call(this,i[1]);return}}}catch{return}}async send(e){if(!this.connectionPromise)throw new Error("sending on closed connection");this.connectionPromise.then(()=>{var t;(t=this.ws)==null||t.send(e)})}async auth(e){const t=this.challenge;if(!t)throw new Error("can't perform auth, no challenge was received");return this.authPromise?this.authPromise:(this.authPromise=new Promise(async(n,r)=>{const o=await e(uo(this.url,t)),i=setTimeout(()=>{const s=this.openEventPublishes.get(o.id);s&&(s.reject(new Error("auth timed out")),this.openEventPublishes.delete(o.id))},this.publishTimeout);this.openEventPublishes.set(o.id,{resolve:n,reject:r,timeout:i}),this.send('["AUTH",'+JSON.stringify(o)+"]")}),this.authPromise)}async publish(e){const t=new Promise((n,r)=>{const o=setTimeout(()=>{const i=this.openEventPublishes.get(e.id);i&&(i.reject(new Error("publish timed out")),this.openEventPublishes.delete(e.id))},this.publishTimeout);this.openEventPublishes.set(e.id,{resolve:n,reject:r,timeout:o})});return this.send('["EVENT",'+JSON.stringify(e)+"]"),t}async count(e,t){this.serial++;const n=(t==null?void 0:t.id)||"count:"+this.serial,r=new Promise((o,i)=>{this.openCountRequests.set(n,{resolve:o,reject:i})});return this.send('["COUNT","'+n+'",'+JSON.stringify(e).substring(1)),r}subscribe(e,t){const n=this.prepareSubscription(e,t);return n.fire(),n}prepareSubscription(e,t){this.serial++;const n=t.id||(t.label?t.label+":":"sub:")+this.serial,r=new Rc(this,n,e,t);return this.openSubs.set(n,r),r}close(){var e;this.closeAllSubscriptions("relay connection closed by us"),this._connected=!1,(e=this.ws)==null||e.close()}_onmessage(e){this.incomingMessageQueue.enqueue(e.data),this.queueRunning||this.runQueue()}},Rc=class{constructor(e,t,n,r){I(this,"relay");I(this,"id");I(this,"closed",!1);I(this,"eosed",!1);I(this,"filters");I(this,"alreadyHaveEvent");I(this,"receivedEvent");I(this,"onevent");I(this,"oneose");I(this,"onclose");I(this,"eoseTimeout");I(this,"eoseTimeoutHandle");this.relay=e,this.filters=n,this.id=t,this.alreadyHaveEvent=r.alreadyHaveEvent,this.receivedEvent=r.receivedEvent,this.eoseTimeout=r.eoseTimeout||e.baseEoseTimeout,this.oneose=r.oneose,this.onclose=r.onclose,this.onevent=r.onevent||(o=>{console.warn(`onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,o)})}fire(){this.relay.send('["REQ","'+this.id+'",'+JSON.stringify(this.filters).substring(1)),this.eoseTimeoutHandle=setTimeout(this.receivedEose.bind(this),this.eoseTimeout)}receivedEose(){var e;this.eosed||(clearTimeout(this.eoseTimeoutHandle),this.eosed=!0,(e=this.oneose)==null||e.call(this))}close(e="closed by caller"){var t;!this.closed&&this.relay.connected&&(this.relay.send('["CLOSE",'+JSON.stringify(this.id)+"]"),this.closed=!0),this.relay.openSubs.delete(this.id),(t=this.onclose)==null||t.call(this,e)}},Uc;try{Uc=WebSocket}catch{}var Nc=class{constructor(e){I(this,"relays",new Map);I(this,"seenOn",new Map);I(this,"trackRelays",!1);I(this,"verifyEvent");I(this,"trustedRelayURLs",new Set);I(this,"_WebSocket");this.verifyEvent=e.verifyEvent,this._WebSocket=e.websocketImplementation}async ensureRelay(e,t){e=Ne(e);let n=this.relays.get(e);return n||(n=new lo(e,{verifyEvent:this.trustedRelayURLs.has(e)?$c:this.verifyEvent,websocketImplementation:this._WebSocket}),t!=null&&t.connectionTimeout&&(n.connectionTimeout=t.connectionTimeout),this.relays.set(e,n)),await n.connect(),n}close(e){e.map(Ne).forEach(t=>{var n;(n=this.relays.get(t))==null||n.close()})}subscribe(e,t,n){return this.subscribeMap(e.map(r=>({url:r,filter:t})),n)}subscribeMany(e,t,n){return this.subscribeMap(e.flatMap(r=>t.map(o=>({url:r,filter:o}))),n)}subscribeMap(e,t){this.trackRelays&&(t.receivedEvent=(f,u)=>{let h=this.seenOn.get(u);h||(h=new Set,this.seenOn.set(u,h)),h.add(f)});const n=new Set,r=[],o=[];let i=f=>{var u;o[f]||(o[f]=!0,o.filter(h=>h).length===e.length&&((u=t.oneose)==null||u.call(t),i=()=>{}))};const s=[];let a=(f,u)=>{var h;s[f]||(i(f),s[f]=u,s.filter(y=>y).length===e.length&&((h=t.onclose)==null||h.call(t,s),a=()=>{}))};const c=f=>{var h;if((h=t.alreadyHaveEvent)!=null&&h.call(t,f))return!0;const u=n.has(f);return n.add(f),u},l=Promise.all(e.map(async({url:f,filter:u},h)=>{f=Ne(f);let y;try{y=await this.ensureRelay(f,{connectionTimeout:t.maxWait?Math.max(t.maxWait*.8,t.maxWait-1e3):void 0})}catch(d){a(h,(d==null?void 0:d.message)||String(d));return}let w=y.subscribe([u],{...t,oneose:()=>i(h),onclose:d=>{d.startsWith("auth-required:")&&t.doauth?y.auth(t.doauth).then(()=>{y.subscribe([u],{...t,oneose:()=>i(h),onclose:p=>{a(h,p)},alreadyHaveEvent:c,eoseTimeout:t.maxWait})}).catch(p=>{a(h,`auth was required and attempted, but failed with: ${p}`)}):a(h,d)},alreadyHaveEvent:c,eoseTimeout:t.maxWait});r.push(w)}));return{async close(){await l,r.forEach(f=>{f.close()})}}}subscribeEose(e,t,n){const r=this.subscribe(e,t,{...n,oneose(){r.close()}});return r}subscribeManyEose(e,t,n){const r=this.subscribeMany(e,t,{...n,oneose(){r.close()}});return r}async querySync(e,t,n){return new Promise(async r=>{const o=[];this.subscribeEose(e,t,{...n,onevent(i){o.push(i)},onclose(i){r(o)}})})}async get(e,t,n){t.limit=1;const r=await this.querySync(e,t,n);return r.sort((o,i)=>i.created_at-o.created_at),r[0]||null}publish(e,t){return e.map(Ne).map(async(n,r,o)=>{if(o.indexOf(n)!==r)return Promise.reject("duplicate url");let i=await this.ensureRelay(n);return i.publish(t).then(s=>{if(this.trackRelays){let a=this.seenOn.get(t.id);a||(a=new Set,this.seenOn.set(t.id,a)),a.add(i)}return s})})}listConnectionStatus(){const e=new Map;return this.relays.forEach((t,n)=>e.set(n,t.connected)),e}destroy(){this.relays.forEach(e=>e.close()),this.relays=new Map}},fo;try{fo=WebSocket}catch{}var Cc=class extends Nc{constructor(){super({verifyEvent:pt,websocketImplementation:fo})}},Oc={};q(Oc,{BECH32_REGEX:()=>ho,Bech32MaxSize:()=>yn,NostrTypeGuard:()=>Hc,decode:()=>wt,decodeNostrURI:()=>Mc,encodeBytes:()=>vt,naddrEncode:()=>Vc,neventEncode:()=>zc,noteEncode:()=>jc,nprofileEncode:()=>Dc,npubEncode:()=>Wc,nsecEncode:()=>qc});var Hc={isNProfile:e=>/^nprofile1[a-z\d]+$/.test(e||""),isNEvent:e=>/^nevent1[a-z\d]+$/.test(e||""),isNAddr:e=>/^naddr1[a-z\d]+$/.test(e||""),isNSec:e=>/^nsec1[a-z\d]{58}$/.test(e||""),isNPub:e=>/^npub1[a-z\d]{58}$/.test(e||""),isNote:e=>/^note1[a-z\d]+$/.test(e||""),isNcryptsec:e=>/^ncryptsec1[a-z\d]+$/.test(e||"")},yn=5e3,ho=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function Pc(e){const t=new Uint8Array(4);return t[0]=e>>24&255,t[1]=e>>16&255,t[2]=e>>8&255,t[3]=e&255,t}function Mc(e){try{return e.startsWith("nostr:")&&(e=e.substring(6)),wt(e)}catch{return{type:"invalid",data:null}}}function wt(e){var o,i,s,a,c,l,f;let{prefix:t,words:n}=He.decode(e,yn),r=new Uint8Array(He.fromWords(n));switch(t){case"nprofile":{let u=Ct(r);if(!((o=u[0])!=null&&o[0]))throw new Error("missing TLV 0 for nprofile");if(u[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:K(u[0][0]),relays:u[1]?u[1].map(h=>ae.decode(h)):[]}}}case"nevent":{let u=Ct(r);if(!((i=u[0])!=null&&i[0]))throw new Error("missing TLV 0 for nevent");if(u[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(u[2]&&u[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(u[3]&&u[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:K(u[0][0]),relays:u[1]?u[1].map(h=>ae.decode(h)):[],author:(s=u[2])!=null&&s[0]?K(u[2][0]):void 0,kind:(a=u[3])!=null&&a[0]?parseInt(K(u[3][0]),16):void 0}}}case"naddr":{let u=Ct(r);if(!((c=u[0])!=null&&c[0]))throw new Error("missing TLV 0 for naddr");if(!((l=u[2])!=null&&l[0]))throw new Error("missing TLV 2 for naddr");if(u[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!((f=u[3])!=null&&f[0]))throw new Error("missing TLV 3 for naddr");if(u[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:ae.decode(u[0][0]),pubkey:K(u[2][0]),kind:parseInt(K(u[3][0]),16),relays:u[1]?u[1].map(h=>ae.decode(h)):[]}}}case"nsec":return{type:t,data:r};case"npub":case"note":return{type:t,data:K(r)};default:throw new Error(`unknown prefix ${t}`)}}function Ct(e){let t={},n=e;for(;n.length>0;){let r=n[0],o=n[1],i=n.slice(2,2+o);if(n=n.slice(2+o),i.length<o)throw new Error(`not enough data to read on TLV ${r}`);t[r]=t[r]||[],t[r].push(i)}return t}function qc(e){return vt("nsec",e)}function Wc(e){return vt("npub",Ie(e))}function jc(e){return vt("note",Ie(e))}function bt(e,t){let n=He.toWords(t);return He.encode(e,n,yn)}function vt(e,t){return bt(e,t)}function Dc(e){let t=wn({0:[Ie(e.pubkey)],1:(e.relays||[]).map(n=>Q.encode(n))});return bt("nprofile",t)}function zc(e){let t;e.kind!==void 0&&(t=Pc(e.kind));let n=wn({0:[Ie(e.id)],1:(e.relays||[]).map(r=>Q.encode(r)),2:e.author?[Ie(e.author)]:[],3:t?[new Uint8Array(t)]:[]});return bt("nevent",n)}function Vc(e){let t=new ArrayBuffer(4);new DataView(t).setUint32(0,e.kind,!1);let n=wn({0:[Q.encode(e.identifier)],1:(e.relays||[]).map(r=>Q.encode(r)),2:[Ie(e.pubkey)],3:[new Uint8Array(t)]});return bt("naddr",n)}function wn(e){let t=[];return Object.entries(e).reverse().forEach(([n,r])=>{r.forEach(o=>{let i=new Uint8Array(o.length+2);i.set([parseInt(n)],0),i.set([o.length],1),i.set(o,2),t.push(i)})}),lt(...t)}var Kc={};q(Kc,{decrypt:()=>Zc,encrypt:()=>po});function po(e,t,n){const r=e instanceof Uint8Array?K(e):e,o=Pe.getSharedSecret(r,"02"+t),i=go(o);let s=Uint8Array.from(kr(16)),a=Q.encode(n),c=qr(i,s).encrypt(a),l=ce.encode(new Uint8Array(c)),f=ce.encode(new Uint8Array(s.buffer));return`${l}?iv=${f}`}function Zc(e,t,n){const r=e instanceof Uint8Array?K(e):e;let[o,i]=n.split("?iv="),s=Pe.getSharedSecret(r,"02"+t),a=go(s),c=ce.decode(i),l=ce.decode(o),f=qr(a,c).decrypt(l);return ae.decode(f)}function go(e){return e.slice(1,33)}var Fc={};q(Fc,{NIP05_REGEX:()=>bn,isNip05:()=>Gc,isValid:()=>Xc,queryProfile:()=>yo,searchDomain:()=>Yc,useFetchImplementation:()=>Jc});var bn=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,Gc=e=>bn.test(e||""),Et;try{Et=fetch}catch{}function Jc(e){Et=e}async function Yc(e,t=""){try{const n=`https://${e}/.well-known/nostr.json?name=${t}`,r=await Et(n,{redirect:"manual"});if(r.status!==200)throw Error("Wrong response code");return(await r.json()).names}catch{return{}}}async function yo(e){var o;const t=e.match(bn);if(!t)return null;const[,n="_",r]=t;try{const i=`https://${r}/.well-known/nostr.json?name=${n}`,s=await Et(i,{redirect:"manual"});if(s.status!==200)throw Error("Wrong response code");const a=await s.json(),c=a.names[n];return c?{pubkey:c,relays:(o=a.relays)==null?void 0:o[c]}:null}catch{return null}}async function Xc(e,t){const n=await yo(t);return n?n.pubkey===e:!1}var Qc={};q(Qc,{parse:()=>eu});function eu(e){const t={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]};let n,r;for(let o=e.tags.length-1;o>=0;o--){const i=e.tags[o];if(i[0]==="e"&&i[1]){const[s,a,c,l,f]=i,u={id:a,relays:c?[c]:[],author:f};if(l==="root"){t.root=u;continue}if(l==="reply"){t.reply=u;continue}if(l==="mention"){t.mentions.push(u);continue}n?r=u:n=u,t.mentions.push(u);continue}if(i[0]==="q"&&i[1]){const[s,a,c]=i;t.quotes.push({id:a,relays:c?[c]:[]})}if(i[0]==="p"&&i[1]){t.profiles.push({pubkey:i[1],relays:i[2]?[i[2]]:[]});continue}}return t.root||(t.root=r||n||t.reply),t.reply||(t.reply=n||t.root),[t.reply,t.root].forEach(o=>{if(!o)return;let i=t.mentions.indexOf(o);if(i!==-1&&t.mentions.splice(i,1),o.author){let s=t.profiles.find(a=>a.pubkey===o.author);s&&s.relays&&(o.relays||(o.relays=[]),s.relays.forEach(a=>{var c;((c=o.relays)==null?void 0:c.indexOf(a))===-1&&o.relays.push(a)}),s.relays=o.relays)}}),t.mentions.forEach(o=>{if(o.author){let i=t.profiles.find(s=>s.pubkey===o.author);i&&i.relays&&(o.relays||(o.relays=[]),i.relays.forEach(s=>{o.relays.indexOf(s)===-1&&o.relays.push(s)}),i.relays=o.relays)}}),t}var tu={};q(tu,{fetchRelayInformation:()=>ru,useFetchImplementation:()=>nu});var wo;try{wo=fetch}catch{}function nu(e){wo=e}async function ru(e){return await(await fetch(e.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}var ou={};q(ou,{fastEventHash:()=>vo,getPow:()=>bo,minePow:()=>iu});function bo(e){let t=0;for(let n=0;n<64;n+=8){const r=parseInt(e.substring(n,n+8),16);if(r===0)t+=32;else{t+=Math.clz32(r);break}}return t}function iu(e,t){let n=0;const r=e,o=["nonce",n.toString(),t.toString()];for(r.tags.push(o);;){const i=Math.floor(new Date().getTime()/1e3);if(i!==r.created_at&&(n=0,r.created_at=i),o[1]=(++n).toString(),r.id=vo(r),bo(r.id)>=t)break}return r}function vo(e){return K(Me(Q.encode(JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content]))))}var su={};q(su,{unwrapEvent:()=>bu,unwrapManyEvents:()=>vu,wrapEvent:()=>Ro,wrapManyEvents:()=>wu});var au={};q(au,{createRumor:()=>Io,createSeal:()=>Lo,createWrap:()=>ko,unwrapEvent:()=>An,unwrapManyEvents:()=>$o,wrapEvent:()=>it,wrapManyEvents:()=>gu});var cu={};q(cu,{decrypt:()=>xn,encrypt:()=>mn,getConversationKey:()=>vn,v2:()=>hu});var Eo=1,mo=65535;function vn(e,t){const n=Pe.getSharedSecret(e,"02"+t).subarray(1,33);return ta(Me,n,"nip44-v2")}function xo(e,t){const n=na(Me,e,t,76);return{chacha_key:n.subarray(0,32),chacha_nonce:n.subarray(32,44),hmac_key:n.subarray(44,76)}}function En(e){if(!Number.isSafeInteger(e)||e<1)throw new Error("expected positive integer");if(e<=32)return 32;const t=1<<Math.floor(Math.log2(e-1))+1,n=t<=256?32:t/8;return n*(Math.floor((e-1)/n)+1)}function uu(e){if(!Number.isSafeInteger(e)||e<Eo||e>mo)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const t=new Uint8Array(2);return new DataView(t.buffer).setUint16(0,e,!1),t}function lu(e){const t=Q.encode(e),n=t.length,r=uu(n),o=new Uint8Array(En(n)-n);return lt(r,t,o)}function fu(e){const t=new DataView(e.buffer).getUint16(0),n=e.subarray(2,2+t);if(t<Eo||t>mo||n.length!==t||e.length!==2+En(t))throw new Error("invalid padding");return ae.decode(n)}function Ao(e,t,n){if(n.length!==32)throw new Error("AAD associated data must be 32 bytes");const r=lt(n,t);return dt(Me,e,r)}function du(e){if(typeof e!="string")throw new Error("payload must be a valid string");const t=e.length;if(t<132||t>87472)throw new Error("invalid payload length: "+t);if(e[0]==="#")throw new Error("unknown encryption version");let n;try{n=ce.decode(e)}catch(i){throw new Error("invalid base64: "+i.message)}const r=n.length;if(r<99||r>65603)throw new Error("invalid data length: "+r);const o=n[0];if(o!==2)throw new Error("unknown encryption version "+o);return{nonce:n.subarray(1,33),ciphertext:n.subarray(33,-32),mac:n.subarray(-32)}}function mn(e,t,n=kr(32)){const{chacha_key:r,chacha_nonce:o,hmac_key:i}=xo(t,n),s=lu(e),a=zr(r,o,s),c=Ao(i,a,n);return ce.encode(lt(new Uint8Array([2]),n,a,c))}function xn(e,t){const{nonce:n,ciphertext:r,mac:o}=du(e),{chacha_key:i,chacha_nonce:s,hmac_key:a}=xo(t,n),c=Ao(a,r,n);if(!Os(c,o))throw new Error("invalid MAC");const l=zr(i,s,r);return fu(l)}var hu={utils:{getConversationKey:vn,calcPaddedLen:En},encrypt:mn,decrypt:xn},pu=2*24*60*60,So=()=>Math.round(Date.now()/1e3),_o=()=>Math.round(So()-Math.random()*pu),Bo=(e,t)=>vn(e,t),To=(e,t,n)=>mn(JSON.stringify(e),Bo(t,n)),Qn=(e,t)=>JSON.parse(xn(e.content,Bo(t,e.pubkey)));function Io(e,t){const n={created_at:So(),content:"",tags:[],...e,pubkey:ln(t)};return n.id=Ye(n),n}function Lo(e,t,n){return oe({kind:Yr,content:To(e,t,n),created_at:_o(),tags:[]},t)}function ko(e,t){const n=la();return oe({kind:oo,content:To(e,n,t),created_at:_o(),tags:[["p",t]]},n)}function it(e,t,n){const r=Io(e,t),o=Lo(r,t,n);return ko(o,n)}function gu(e,t,n){if(!n||n.length===0)throw new Error("At least one recipient is required.");const r=ln(t),o=[it(e,t,r)];return n.forEach(i=>{o.push(it(e,t,i))}),o}function An(e,t){const n=Qn(e,t);return Qn(n,t)}function $o(e,t){let n=[];return e.forEach(r=>{n.push(An(r,t))}),n.sort((r,o)=>r.created_at-o.created_at),n}function yu(e,t,n,r){const o={created_at:Math.ceil(Date.now()/1e3),kind:Xr,tags:[],content:t};return(Array.isArray(e)?e:[e]).forEach(({publicKey:s,relayUrl:a})=>{o.tags.push(a?["p",s,a]:["p",s])}),r&&o.tags.push(["e",r.eventId,r.relayUrl||"","reply"]),n&&o.tags.push(["subject",n]),o}function Ro(e,t,n,r,o){const i=yu(t,n,r,o);return it(i,e,t.publicKey)}function wu(e,t,n,r,o){if(!t||t.length===0)throw new Error("At least one recipient is required.");return[{publicKey:ln(e)},...t].map(s=>Ro(e,s,n,r,o))}var bu=An,vu=$o,Eu={};q(Eu,{finishRepostEvent:()=>mu,getRepostedEvent:()=>xu,getRepostedEventPointer:()=>Uo});function mu(e,t,n,r){var s;let o;const i=[...e.tags??[],["e",t.id,n],["p",t.pubkey]];return t.kind===Jr?o=dn:(o=pn,i.push(["k",String(t.kind)])),oe({kind:o,tags:i,content:e.content===""||(s=t.tags)!=null&&s.find(a=>a[0]==="-")?"":JSON.stringify(t),created_at:e.created_at},r)}function Uo(e){if(![dn,pn].includes(e.kind))return;let t,n;for(let r=e.tags.length-1;r>=0&&(t===void 0||n===void 0);r--){const o=e.tags[r];o.length>=2&&(o[0]==="e"&&t===void 0?t=o:o[0]==="p"&&n===void 0&&(n=o))}if(t!==void 0)return{id:t[1],relays:[t[2],n==null?void 0:n[2]].filter(r=>typeof r=="string"),author:n==null?void 0:n[1]}}function xu(e,{skipVerification:t}={}){const n=Uo(e);if(n===void 0||e.content==="")return;let r;try{r=JSON.parse(e.content)}catch{return}if(r.id===n.id&&!(!t&&!pt(r)))return r}var Au={};q(Au,{NOSTR_URI_REGEX:()=>Sn,parse:()=>_u,test:()=>Su});var Sn=new RegExp(`nostr:(${ho.source})`);function Su(e){return typeof e=="string"&&new RegExp(`^${Sn.source}$`).test(e)}function _u(e){const t=e.match(new RegExp(`^${Sn.source}$`));if(!t)throw new Error(`Invalid Nostr URI: ${e}`);return{uri:t[0],value:t[1],decoded:wt(t[1])}}var Bu={};q(Bu,{finishReactionEvent:()=>Tu,getReactedEventPointer:()=>Iu});function Tu(e,t,n){const r=t.tags.filter(o=>o.length>=2&&(o[0]==="e"||o[0]==="p"));return oe({...e,kind:hn,tags:[...e.tags??[],...r,["e",t.id],["p",t.pubkey]],content:e.content??"+"},n)}function Iu(e){if(e.kind!==hn)return;let t,n;for(let r=e.tags.length-1;r>=0&&(t===void 0||n===void 0);r--){const o=e.tags[r];o.length>=2&&(o[0]==="e"&&t===void 0?t=o:o[0]==="p"&&n===void 0&&(n=o))}if(!(t===void 0||n===void 0))return{id:t[1],relays:[t[2],n[2]].filter(r=>r!==void 0),author:n[1]}}var Lu={};q(Lu,{parse:()=>$u});var ku=/\W/m,er=/\W |\W$|$|,| /m;function*$u(e){const t=e.length;let n=0,r=0;for(;r<t;){let o=e.indexOf(":",r);if(o===-1)break;if(e.substring(o-5,o)==="nostr"){const i=e.substring(o+60).match(ku),s=i?o+60+i.index:t;try{let a,{data:c,type:l}=wt(e.substring(o+1,s));switch(l){case"npub":a={pubkey:c};break;case"nsec":case"note":r=s+1;continue;default:a=c}n!==o-5&&(yield{type:"text",text:e.substring(n,o-5)}),yield{type:"reference",pointer:a},r=s,n=r;continue}catch{r=o+1;continue}}else if(e.substring(o-5,o)==="https"||e.substring(o-4,o)==="http"){const i=e.substring(o+4).match(er),s=i?o+4+i.index:t,a=e[o-1]==="s"?5:4;try{let c=new URL(e.substring(o-a,s));if(c.hostname.indexOf(".")===-1)throw new Error("invalid url");if(n!==o-a&&(yield{type:"text",text:e.substring(n,o-a)}),c.pathname.endsWith(".png")||c.pathname.endsWith(".jpg")||c.pathname.endsWith(".jpeg")||c.pathname.endsWith(".gif")||c.pathname.endsWith(".webp")){yield{type:"image",url:c.toString()},r=s,n=r;continue}if(c.pathname.endsWith(".mp4")||c.pathname.endsWith(".avi")||c.pathname.endsWith(".webm")||c.pathname.endsWith(".mkv")){yield{type:"video",url:c.toString()},r=s,n=r;continue}if(c.pathname.endsWith(".mp3")||c.pathname.endsWith(".aac")||c.pathname.endsWith(".ogg")||c.pathname.endsWith(".opus")){yield{type:"audio",url:c.toString()},r=s,n=r;continue}yield{type:"url",url:c.toString()},r=s,n=r;continue}catch{r=s+1;continue}}else if(e.substring(o-3,o)==="wss"||e.substring(o-2,o)==="ws"){const i=e.substring(o+4).match(er),s=i?o+4+i.index:t,a=e[o-1]==="s"?3:2;try{let c=new URL(e.substring(o-a,s));if(c.hostname.indexOf(".")===-1)throw new Error("invalid ws url");n!==o-a&&(yield{type:"text",text:e.substring(n,o-a)}),yield{type:"relay",url:c.toString()},r=s,n=r;continue}catch{r=s+1;continue}}else{r=o+1;continue}}n!==t&&(yield{type:"text",text:e.substring(n)})}var Ru={};q(Ru,{channelCreateEvent:()=>Uu,channelHideMessageEvent:()=>Ou,channelMessageEvent:()=>Cu,channelMetadataEvent:()=>Nu,channelMuteUserEvent:()=>Hu});var Uu=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return oe({kind:Qr,tags:[...e.tags??[]],content:n,created_at:e.created_at},t)},Nu=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return oe({kind:eo,tags:[["e",e.channel_create_event_id],...e.tags??[]],content:n,created_at:e.created_at},t)},Cu=(e,t)=>{const n=[["e",e.channel_create_event_id,e.relay_url,"root"]];return e.reply_to_channel_message_event_id&&n.push(["e",e.reply_to_channel_message_event_id,e.relay_url,"reply"]),oe({kind:to,tags:[...n,...e.tags??[]],content:e.content,created_at:e.created_at},t)},Ou=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return oe({kind:no,tags:[["e",e.channel_message_event_id],...e.tags??[]],content:n,created_at:e.created_at},t)},Hu=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return oe({kind:ro,tags:[["p",e.pubkey_to_mute],...e.tags??[]],content:n,created_at:e.created_at},t)},Pu={};q(Pu,{EMOJI_SHORTCODE_REGEX:()=>No,matchAll:()=>Mu,regex:()=>_n,replaceAll:()=>qu});var No=/:(\w+):/,_n=()=>new RegExp(`\\B${No.source}\\B`,"g");function*Mu(e){const t=e.matchAll(_n());for(const n of t)try{const[r,o]=n;yield{shortcode:r,name:o,start:n.index,end:n.index+r.length}}catch{}}function qu(e,t){return e.replaceAll(_n(),(n,r)=>t({shortcode:n,name:r}))}var Wu={};q(Wu,{useFetchImplementation:()=>ju,validateGithub:()=>Du});var Bn;try{Bn=fetch}catch{}function ju(e){Bn=e}async function Du(e,t,n){try{return await(await Bn(`https://gist.github.com/${t}/${n}/raw`)).text()===`Verifying that I control the following Nostr public key: ${e}`}catch{return!1}}var zu={};q(zu,{makeNwcRequestEvent:()=>Ku,parseConnectionString:()=>Vu});function Vu(e){const{pathname:t,searchParams:n}=new URL(e),r=t,o=n.get("relay"),i=n.get("secret");if(!r||!o||!i)throw new Error("invalid connection string");return{pubkey:r,relay:o,secret:i}}async function Ku(e,t,n){const o=po(t,e,JSON.stringify({method:"pay_invoice",params:{invoice:n}})),i={kind:so,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",e]]};return oe(i,t)}var Zu={};q(Zu,{normalizeIdentifier:()=>Fu});function Fu(e){return e=e.trim().toLowerCase(),e=e.normalize("NFKC"),Array.from(e).map(t=>new RegExp("\\p{Letter}","u").test(t)||new RegExp("\\p{Number}","u").test(t)?t:"-").join("")}var Gu={};q(Gu,{getSatoshisAmountFromBolt11:()=>tl,getZapEndpoint:()=>Yu,makeZapReceipt:()=>el,makeZapRequest:()=>Xu,useFetchImplementation:()=>Ju,validateZapRequest:()=>Qu});var Tn;try{Tn=fetch}catch{}function Ju(e){Tn=e}async function Yu(e){try{let t="",{lud06:n,lud16:r}=JSON.parse(e.content);if(n){let{words:s}=He.decode(n,1e3),a=He.fromWords(s);t=ae.decode(a)}else if(r){let[s,a]=r.split("@");t=new URL(`/.well-known/lnurlp/${s}`,`https://${a}`).toString()}else return null;let i=await(await Tn(t)).json();if(i.allowsNostr&&i.nostrPubkey)return i.callback}catch{}return null}function Xu({profile:e,event:t,amount:n,relays:r,comment:o=""}){if(!n)throw new Error("amount not given");if(!e)throw new Error("profile not given");let i={kind:9734,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",e],["amount",n.toString()],["relays",...r]]};if(t&&typeof t=="string"&&i.tags.push(["e",t]),t&&typeof t=="object"){if(fn(t.kind)){const s=["a",`${t.kind}:${t.pubkey}:`];i.tags.push(s)}else if(gt(t.kind)){let s=t.tags.find(([c,l])=>c==="d"&&l);if(!s)throw new Error("d tag not found or is empty");const a=["a",`${t.kind}:${t.pubkey}:${s[1]}`];i.tags.push(a)}}return i}function Qu(e){let t;try{t=JSON.parse(e)}catch{return"Invalid zap request JSON."}if(!cn(t))return"Zap request is not a valid Nostr event.";if(!pt(t))return"Invalid signature on zap request.";let n=t.tags.find(([i,s])=>i==="p"&&s);if(!n)return"Zap request doesn't have a 'p' tag.";if(!n[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=t.tags.find(([i,s])=>i==="e"&&s);return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":t.tags.find(([i,s])=>i==="relays"&&s)?null:"Zap request doesn't have a 'relays' tag."}function el({zapRequest:e,preimage:t,bolt11:n,paidAt:r}){let o=JSON.parse(e),i=o.tags.filter(([a])=>a==="e"||a==="p"||a==="a"),s={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...i,["P",o.pubkey],["bolt11",n],["description",e]]};return t&&s.tags.push(["preimage",t]),s}function tl(e){if(e.length<50)return 0;e=e.substring(0,50);const t=e.lastIndexOf("1");if(t===-1)return 0;const n=e.substring(0,t);if(!n.startsWith("lnbc"))return 0;const r=n.substring(4);if(r.length<1)return 0;const o=r[r.length-1],i=o.charCodeAt(0)-48,s=i>=0&&i<=9;let a=r.length-1;if(s&&a++,a<1)return 0;const c=parseInt(r.substring(0,a));switch(o){case"m":return c*1e5;case"u":return c*100;case"n":return c/10;case"p":return c/1e4;default:return c*1e8}}var nl={};q(nl,{getToken:()=>rl,hashPayload:()=>In,unpackEventFromToken:()=>Oo,validateEvent:()=>jo,validateEventKind:()=>Po,validateEventMethodTag:()=>qo,validateEventPayloadTag:()=>Wo,validateEventTimestamp:()=>Ho,validateEventUrlTag:()=>Mo,validateToken:()=>ol});var Co="Nostr ";async function rl(e,t,n,r=!1,o){const i={kind:gn,tags:[["u",e],["method",t]],created_at:Math.round(new Date().getTime()/1e3),content:""};o&&i.tags.push(["payload",In(o)]);const s=await n(i);return(r?Co:"")+ce.encode(Q.encode(JSON.stringify(s)))}async function ol(e,t,n){const r=await Oo(e).catch(i=>{throw i});return await jo(r,t,n).catch(i=>{throw i})}async function Oo(e){if(!e)throw new Error("Missing token");e=e.replace(Co,"");const t=ae.decode(ce.decode(e));if(!t||t.length===0||!t.startsWith("{"))throw new Error("Invalid token");return JSON.parse(t)}function Ho(e){return e.created_at?Math.round(new Date().getTime()/1e3)-e.created_at<60:!1}function Po(e){return e.kind===gn}function Mo(e,t){const n=e.tags.find(r=>r[0]==="u");return n?n.length>0&&n[1]===t:!1}function qo(e,t){const n=e.tags.find(r=>r[0]==="method");return n?n.length>0&&n[1].toLowerCase()===t.toLowerCase():!1}function In(e){const t=Me(Q.encode(JSON.stringify(e)));return K(t)}function Wo(e,t){const n=e.tags.find(o=>o[0]==="payload");if(!n)return!1;const r=In(t);return n.length>0&&n[1]===r}async function jo(e,t,n,r){if(!pt(e))throw new Error("Invalid nostr event, signature invalid");if(!Po(e))throw new Error("Invalid nostr event, kind invalid");if(!Ho(e))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!Mo(e,t))throw new Error("Invalid nostr event, url tag invalid");if(!qo(e,n))throw new Error("Invalid nostr event, method tag invalid");if(r&&typeof r=="object"&&Object.keys(r).length>0&&!Wo(e,r))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0}const Ln=new Cc;let mt=[];mt=["wss://relay.damus.io","wss://nostr.mom/","wss://relay.nostr.band","wss://relay.8333.space","wss://nostr-pub.wellorder.net","wss://nostr.oxtr.dev","wss://nos.lol"];function yl(e){return Ln.querySync(mt,e)}function wl(e){return Ln.get(mt,e)}function bl(e){return Ln.publish(mt,e)}export{yi as a,cl as b,ll as c,wl as g,Oc as n,bl as p,yl as q,ul as r,Qe as s};
